!======================================================================================================================!
!                                                                                                                      !
!     Program:      ACCESS                                                                                             !
!                   Atmospheric Chemistry and Canopy Exchange Simulation System                                        !
!                   Full BVOC chemistry version                                                                        !
!                                                                                                                      !
!     Version:      3.1.0                                                                                              !
!                                                                                                                      !
!======================================================================================================================!
!                                                                                                                      !
!     Last Update:  Dec 2017                                                                                           !
!                                                                                                                      !
!     Contact:      Rick D. Saylor, PhD                                                                                !
!                   Physical Scientist                                                                                 !
!                   U. S. Department of Commerce                                                                       !
!                   National Oceanic and Atmospheric Administration                                                    !
!                   Air Resources Laboratory                                                                           !
!                   Atmospheric Turbulence and Diffusion Division                                                      !
!                   456 S. Illinois Ave                                                                                !
!                   Oak Ridge, TN 37830                                                                                !
!                   email: Rick.Saylor@noaa.gov                                                                        !
!                                                                                                                      !
!**********************************************************************************************************************!
!                   NOTE: See Legal Notice in Main.f90                                                                 !
!**********************************************************************************************************************!
!                                                                                                                      !
!     Module:       GasChem                                                                                            !
!                                                                                                                      !
!     Description:  Contains all routines related to gas-phase chemistry                                               !
!                                                                                                                      !
!======================================================================================================================!
module GasChem
  use GlobalData
  use Utils
  implicit none

  private GasPhotoRateCoeffs, GasThermalRateCoeffs,   &
          CalcJPhoto, fjo3a, fjo3b, fjh2o2, fjno2, fjno3a, fjno3b, fjhono,      &
          fjhno3, fjho2no2, fjhchoa, fjhchob, fjch3cho, fjc2h5cho, fjc3h7choa,  &
          fjc3h7chob, fjic3h7cho, fjmacra, fjmacrb, fjacet, fjmek, fjmvka,      &
          fjmvkb, fjglyoxa, fjglyoxb, fjglyoxc, fjmglyox, fjbiacet, fjch3ooh,   &
          fjch3no3, fjc2h5no3, fjnc3h7no3, fjic3h7no3, fjtc4h9no3, fjnoaa,      &
          fjnoab, fjhoch2cho, fjacetol, fjpaa, fjpyra, fjhpald, fjacro, fjhmhp, &
          fjneth, fjnacet, fjpana, fjpanb, fjppna, fjppnb, fjn2o5a, fjn2o5b,    & 
          fjbald, ARR, ARR2, TERM, TJPL, TERCO, KTYP2, KTYP3, KTYPHO2
  public fgaschem, RxnRates, GasRateCoeffs
contains

!**********************************************************************************************************************!
! fgaschem - used by ODE solver to define the chemical system
!**********************************************************************************************************************!
subroutine fgaschem(neqn, ts, y, yp )
  integer(kind=i4) :: neqn
  real(kind=dp) ts
  real(kind=dp), dimension(neqn) :: y
  real(kind=dp), dimension(neqn) :: yp
  real(kind=dp), dimension(nrxn) :: k       ! reaction rate coefficients
  real(kind=dp), dimension(nrxn) :: r       ! reaction rates

  ! get reaction rate coefficients
  call GasRateCoeffs(ts, k)

  ! calculate reaction rates
  call RxnRates(neqn, k, y, r)

  ! Generated by chmgen for mechanism racm2_plus
  yp(iO3)        = -r(1)-r(2)-r(59)-r(60)-r(61)-r(62)+r(63)-r(64)-r(151)-r(152)-r(153)-r(154)-r(155) &
                    -r(156)-r(157)-r(158)-r(159)-r(160)-r(161)-r(162)-r(163)-r(164)-r(165)+0.2*r(263) &
                    -r(408)-r(415)-r(422)-r(438)+0.2*r(446)-r(458)
  yp(iNO)        = +r(4)+r(5)+r(7)-r(61)-r(73)-r(74)-r(75)-r(76)-r(77)-r(77)+r(79)-r(85)+r(86)-r(196) &
                    -r(197)-r(198)-r(199)-r(200)-r(201)-r(202)-r(203)-r(204)-r(205)-r(206)-r(207)-r(208) &
                    -r(209)-r(210)-r(211)-r(212)-r(213)-r(214)-r(215)-r(216)-r(217)-r(218)-r(219)-r(220) &
                    -r(221)-r(222)-r(223)-r(224)-r(225)-r(226)-r(227)-r(228)-r(229)-r(230)-r(231)-r(232) &
                    -r(233)-r(234)-r(235)-r(416)-r(423)-r(430)-r(440)-r(445)-r(452)-r(459)-r(470)
  yp(iNO2)       = -r(4)+r(6)+r(8)+0.80*r(9)+r(31)+r(32)+r(34)+r(35)+r(36)+r(37)+r(38)+r(39)+r(40)+r(41) &
                    +r(44)+r(45)+r(46)+0.314*r(47)+r(57)+r(58)+r(61)-r(62)+r(73)+r(75)+2.0*r(77)+r(78) &
                    -r(79)-r(80)-r(81)+r(83)+0.7*r(84)+2.0*r(85)-r(86)+r(86)+2.0*r(87)-r(88)+r(89)-r(91) &
                    +r(92)+r(93)+r(148)+r(149)+r(150)+0.50*r(181)+r(183)-r(190)+r(191)-r(192)+r(193)-r(194) &
                    +r(195)+r(196)+r(197)+0.935*r(198)+0.864*r(199)+0.803*r(200)+r(201)+0.97*r(202)+0.95 &
                    *r(203)+0.918*r(204)+r(205)+0.95*r(206)+0.95*r(207)+r(208)+0.95*r(209)+0.95*r(210)+0.95 &
                    *r(211)+0.883*r(212)+0.82*r(213)+0.78*r(214)+r(215)+r(216)+r(217)+r(218)+0.983*r(219) &
                    +r(220)+r(221)+0.89*r(222)+r(223)+r(224)+r(225)+r(226)+r(227)+r(228)+r(229)+r(230) &
                    +r(231)+2.00*r(232)+2.0*r(233)+2.0*r(234)+r(235)-r(236)-r(237)-r(238)+r(302)+0.500 &
                    *r(311)+0.500*r(313)+r(314)+r(340)+r(350)+r(351)+0.7*r(352)+r(355)+r(356)+r(357)+r(358) &
                    +r(359)+r(360)+r(361)+r(362)+r(363)+r(364)+r(365)+r(366)+r(367)+r(368)+r(369)+r(370) &
                    +r(371)+r(372)+r(373)+r(374)+r(375)+r(376)+r(377)+r(378)+r(379)+r(380)+r(381)+r(382) &
                    +r(383)+r(384)+r(385)+r(386)+r(387)+r(388)+r(389)+2.00*r(390)+2.00*r(391)+2.0*r(392)+0.50 &
                    *r(395)+0.500*r(396)+r(398)+r(399)+r(400)+0.50*r(401)+0.500*r(402)+r(403)+r(410)+r(411) &
                    +r(412)+0.445*r(415)+1.34*r(416)+0.235*r(418)+0.336*r(419)+1.336*r(420)+0.327*r(422)+1.6 &
                    *r(423)+0.343*r(425)+0.562*r(426)+1.6*r(427)+r(430)+r(432)+r(433)+r(434)+r(435)+r(440) &
                    +r(444)+r(445)+r(449)-r(450)+r(452)+r(456)+r(459)+r(463)+0.85*r(470)+r(474)+0.85*r(476)
  yp(iO3P)       = +r(1)+r(4)+r(6)-r(63)-r(64)+r(65)+r(66)-r(73)-r(79)-r(80)+0.09*r(154)
  yp(iO1D)       = +r(2)-r(65)-r(66)-r(67)
  yp(iH2O2)      = -r(3)+r(70)+r(71)-r(72)+0.068*r(152)+0.026*r(153)+0.001*r(154)+0.09*r(155)+0.02*r(156)+0.02 &
                    *r(157)+0.144*r(158)+0.09*r(159)+0.075*r(415)+0.102*r(422)+0.076*r(438)+0.076*r(458)
  yp(iHO)        = +2.0*r(3)+r(7)+r(8)+0.20*r(9)+r(28)+r(29)+r(30)+1.0*r(42)+r(43)+r(47)+r(49)+r(55) &
                    +r(56)-r(59)+r(60)+2.0*r(67)-r(68)-r(69)-r(72)-r(74)+r(75)-r(78)-r(81)-r(82)-r(83)+0.7 &
                    *r(84)-r(93)-r(94)-r(95)-r(96)-r(97)-r(98)-r(99)-r(100)-r(101)-r(102)-r(103)-r(104) &
                    -r(105)+0.650*r(105)-r(106)-r(107)-r(108)-r(109)-r(110)-r(111)-r(112)-r(113)-r(114) &
                    -r(115)-r(116)-r(117)-r(118)-r(119)-r(120)-r(121)-r(122)-r(123)-r(124)-r(125)-r(126) &
                    -r(127)-r(128)-r(129)-r(130)-r(131)-r(132)-r(133)-r(134)-r(135)-r(136)-r(137)-r(138)+0.35 &
                    *r(138)-r(139)+0.01*r(139)-r(140)+r(140)-r(141)+0.3*r(141)-r(142)-r(143)-r(144)-r(145)+0.35 &
                    *r(145)-r(146)-r(147)-r(148)-r(149)-r(150)+0.08*r(151)+0.22*r(152)+0.46*r(153)+0.28 &
                    *r(154)+0.25*r(155)+0.85*r(156)+0.85*r(157)+0.238*r(158)+0.36*r(159)+0.100*r(160)+0.05 &
                    *r(161)+0.05*r(162)+0.05*r(163)+0.05*r(164)+0.50*r(181)+0.28*r(184)+0.49*r(185)+0.158 &
                    *r(186)+0.390*r(187)+0.158*r(188)+0.390*r(189)+0.12*r(255)+0.44*r(258)+0.44*r(259)+0.150 &
                    *r(260)+0.4*r(263)+0.469*r(265)-r(406)-r(407)-r(409)-r(410)-r(411)-r(412)-r(414)+0.89 &
                    *r(415)-r(421)+0.526*r(422)-r(428)+r(428)-r(429)+0.125*r(430)+1.125*r(431)+0.125*r(432) &
                    -r(433)-r(434)-r(435)-r(436)+0.443*r(436)-r(437)+0.89*r(438)+0.348*r(441)+0.4*r(446) &
                    -r(451)+0.67*r(453)-r(457)+0.89*r(458)-r(464)-r(465)-r(467)-r(468)+r(469)-r(475)+0.3 &
                    *r(475)-r(476)-r(477)
  yp(iNO3)       = -r(5)-r(6)+0.20*r(9)+r(33)+r(62)+r(80)+r(82)-r(83)-r(84)-r(85)-r(86)-r(87)-r(87)-r(88) &
                    +r(89)+r(146)+r(147)-r(166)-r(167)-r(168)-r(169)-r(170)-r(171)-r(172)-r(173)-r(174) &
                    -r(175)-r(176)-r(177)-r(178)-r(179)-r(180)-r(181)-r(182)-r(183)-r(355)-r(356)-r(357) &
                    -r(358)-r(359)-r(360)-r(361)-r(362)-r(363)-r(364)-r(365)-r(366)-r(367)-r(368)-r(369) &
                    -r(370)-r(371)-r(372)-r(373)-r(374)-r(375)-r(376)-r(377)-r(378)-r(379)-r(380)-r(381) &
                    -r(382)-r(383)-r(384)-r(385)-r(386)-r(387)-r(388)-r(389)-r(390)-r(391)-r(392)-r(403) &
                    +r(409)+0.31*r(416)+0.216*r(418)+0.309*r(419)-r(420)+0.309*r(420)-r(427)-r(432)-r(439) &
                    -r(444)-r(449)-r(456)-r(463)-r(466)-r(474)+0.15*r(476)+r(477)
  yp(iHONO)      = -r(7)+r(74)-r(78)
  yp(iHNO3)      = -r(8)+r(76)+r(81)-r(82)+0.3*r(84)+2.0*r(90)+r(172)+r(173)+r(174)+r(175)+r(176)+r(177) &
                    +r(178)+0.5*r(179)+0.5*r(180)+0.50*r(181)+r(182)+r(439)+r(466)
  yp(iHNO4)      = -r(9)+r(91)-r(92)-r(93)
  yp(iHO2)       = +0.80*r(9)+r(11)+r(11)+r(12)+r(13)+1.22*r(15)+r(18)+r(19)+2*r(23)+r(24)+1.5*r(25)+1.5 &
                    *r(26)+r(27)+r(28)+r(29)+r(31)+r(42)+0.892*r(43)+r(45)+0.686*r(47)+1.24*r(48)+r(49)+1.52 &
                    *r(50)+r(51)+2.0*r(52)+r(53)+r(54)+0.3*r(56)+r(57)+r(59)-r(60)+r(68)-r(69)-r(70)-r(70) &
                    -r(71)-r(71)+r(72)-r(75)-r(76)+r(83)-r(84)-r(91)+r(92)+r(94)+r(95)+0.049*r(100)+0.350 &
                    *r(105)+0.648*r(106)+0.177*r(107)+0.177*r(108)+0.177*r(109)+0.177*r(110)+r(114)+r(120) &
                    +r(124)+0.52*r(126)+0.52*r(127)+0.56*r(128)+0.73*r(130)+0.73*r(131)+r(132)+r(134) &
                    +r(135)+r(136)+r(137)+r(143)+0.15*r(151)+0.32*r(152)+0.07*r(153)+0.30*r(154)+0.25 &
                    *r(155)+0.10*r(156)+0.10*r(157)+0.14*r(158)+0.28*r(159)+0.072*r(160)+r(161)+r(162) &
                    +r(163)+1.5*r(164)+r(172)+r(177)+1.50*r(181)+0.29*r(184)+0.01*r(185)+0.308*r(186)+0.010 &
                    *r(187)+0.308*r(188)+0.010*r(189)+r(196)+r(197)+0.207*r(198)+0.438*r(199)+0.658*r(200) &
                    +r(201)+0.78*r(202)+0.83*r(203)+0.918*r(204)+0.95*r(206)+0.95*r(207)+0.95*r(209)+0.95 &
                    *r(210)+0.95*r(211)+0.803*r(212)+0.82*r(213)+0.686*r(214)+0.67*r(218)+0.757*r(219)+0.50 &
                    *r(221)+0.265*r(222)+r(223)+r(226)+r(228)+r(229)+r(230)+r(231)-r(239)-r(240)-r(241) &
                    -r(242)-r(243)-r(244)-r(245)-r(246)-r(247)-r(248)-r(249)-r(250)-r(251)-r(252)-r(253) &
                    -r(254)-r(255)+0.12*r(255)-r(256)-r(257)-r(258)-r(259)-r(260)-r(261)-r(262)-r(263) &
                    -r(264)-r(265)-r(266)-r(267)-r(268)-r(269)-r(270)-r(271)-r(272)-r(273)-r(274)-r(275) &
                    -r(276)+0.74*r(277)+r(278)+0.894*r(279)+0.842*r(280)+0.910*r(281)+r(282)+r(283)+r(284)+1.60 &
                    *r(285)+r(286)+2.0*r(287)+2.0*r(288)+r(289)+2.0*r(290)+2.0*r(291)+2.0*r(292)+r(293) &
                    +r(294)+r(295)+0.9*r(296)+0.9*r(297)+0.50*r(298)+0.834*r(299)+r(300)+0.9*r(301)+r(302)+0.65 &
                    *r(303)+r(304)+r(305)+r(306)+2.0*r(307)+r(308)+r(309)+2.0*r(310)+0.500*r(311)+2.0 &
                    *r(312)+0.500*r(313)+r(314)+r(315)+0.500*r(316)+0.394*r(317)+0.342*r(318)+0.303*r(319)+0.5 &
                    *r(320)+0.500*r(321)+0.500*r(322)+0.60*r(323)+r(325)+r(326)+r(328)+r(329)+r(330)+0.5 &
                    *r(331)+0.5*r(332)+0.5*r(333)+0.33*r(337)+0.50*r(338)+0.50*r(340)+0.27*r(341)+0.5 &
                    *r(342)+2.00*r(345)+r(346)+r(348)+r(349)+r(352)+r(355)+r(356)+0.254*r(357)+0.488*r(358)+0.820 &
                    *r(359)+r(360)+0.79*r(361)+0.86*r(362)+r(363)+r(365)+0.50*r(366)+r(368)+r(369)+r(370) &
                    +r(371)+r(372)+r(373)+0.67*r(377)+r(378)+r(380)+0.3*r(381)+r(382)+r(385)+r(387)+r(388) &
                    +r(389)+r(393)+r(394)+0.50*r(395)+0.500*r(396)+r(397)+0.50*r(401)+0.500*r(402)+r(413)+0.445 &
                    *r(415)+0.35*r(416)-r(417)+0.949*r(418)+0.355*r(419)+0.355*r(420)+0.327*r(422)+0.4 &
                    *r(423)-r(424)+0.801*r(425)+0.374*r(426)+0.4*r(427)+0.825*r(430)-r(431)+0.825*r(431)+0.825 &
                    *r(432)+0.659*r(438)+r(440)-r(441)+1.4*r(442)+r(443)+r(444)+r(445)-r(446)+1.8*r(447) &
                    +r(448)+r(449)+r(452)-r(453)+0.67*r(453)+1.208*r(454)+0.952*r(455)+r(456)+0.445*r(458) &
                    +r(459)-r(460)+1.4*r(461)+r(462)+r(463)+r(464)+0.2*r(465)+0.5*r(467)+0.85*r(470)-r(471)+1.344 &
                    *r(472)+0.986*r(473)+0.855*r(474)+0.145*r(474)
  yp(iHCHO)      = -r(10)-r(11)+0.35*r(15)+r(18)+0.5*r(19)+r(22)+r(28)+r(42)+0.69*r(43)+r(44)+r(45)+0.07 &
                    *r(47)+r(51)+r(52)+0.3*r(56)-r(114)+r(134)+0.35*r(138)+0.35*r(145)+r(146)+r(147)+r(151)+0.56 &
                    *r(152)+0.09*r(153)+0.90*r(154)+0.58*r(155)+0.04*r(157)+0.242*r(158)+0.545*r(159)+0.080 &
                    *r(160)+0.05*r(161)+0.05*r(162)-r(172)+r(196)+0.018*r(199)+1.6*r(201)+0.78*r(202)+0.66 &
                    *r(212)+0.23*r(213)+0.231*r(214)+r(217)+0.33*r(218)+r(220)+0.50*r(221)+0.265*r(222)+0.03 &
                    *r(223)+0.287*r(232)+0.287*r(233)+0.12*r(255)+0.150*r(260)+0.4*r(263)+1.37*r(277)+0.75 &
                    *r(278)+0.827*r(279)+0.777*r(280)+0.750*r(281)+1.95*r(282)+1.50*r(283)+0.750*r(284) &
                    +r(285)+r(286)+r(287)+r(288)+r(289)+r(290)+r(291)+r(292)+1.31*r(293)+0.750*r(294)+1.04 &
                    *r(295)+r(296)+r(297)+1.50*r(298)+r(299)+0.75*r(300)+1.9*r(301)+1.50*r(302)+0.9*r(303)+0.773 &
                    *r(304)+r(305)+r(306)+r(307)+r(308)+r(309)+r(310)+0.965*r(311)+r(312)+0.965*r(313) &
                    +r(314)+r(315)+0.130*r(317)+0.042*r(318)+1.6*r(320)+r(321)+1.048*r(331)+0.385*r(333) &
                    +r(336)+0.33*r(337)+r(339)+r(340)+0.27*r(341)+0.030*r(342)+0.287*r(350)+0.287*r(351) &
                    +r(355)+0.024*r(358)+1.6*r(360)+0.79*r(361)+0.75*r(371)+0.385*r(373)+r(376)+0.33*r(377) &
                    +r(379)+r(380)+0.3*r(381)+0.03*r(382)+0.287*r(390)+0.287*r(391)+0.202*r(395)+0.202 &
                    *r(396)+0.504*r(398)+0.504*r(399)+0.504*r(400)+0.202*r(401)+0.202*r(402)+0.214*r(415)+0.72 &
                    *r(416)+1.506*r(418)+0.723*r(419)+0.723*r(420)+0.541*r(422)+0.4*r(423)+1.069*r(425)+0.374 &
                    *r(426)+0.4*r(427)+0.375*r(430)+0.375*r(431)+0.375*r(432)+r(434)+0.231*r(438)+r(442) &
                    +r(447)+0.88*r(454)+r(461)+0.425*r(470)+1.037*r(472)+0.131*r(473)+0.145*r(474)+0.08 &
                    *r(476)+0.35*r(477)
  yp(iCO)        = +r(10)+r(11)+r(12)+r(13)+1.22*r(15)+0.825*r(19)+0.6*r(20)+2*r(21)+r(22)+2*r(23)+r(24) &
                    +r(25)+r(26)+r(27)+r(45)+0.74*r(48)+0.058*r(49)+2.0*r(50)+r(52)+r(53)+r(57)-r(95)+0.350 &
                    *r(105)+r(114)+2.0*r(124)+r(125)+0.33*r(126)+0.33*r(127)+0.11*r(128)+r(132)+0.43*r(151)+0.43 &
                    *r(152)+0.37*r(153)+0.36*r(154)+0.14*r(155)+0.14*r(156)+0.14*r(157)+0.652*r(158)+0.56 &
                    *r(159)+0.243*r(160)+1.50*r(161)+1.50*r(162)+1.50*r(163)+1.5*r(164)+r(172)+2.0*r(177) &
                    +r(178)+1.50*r(181)+r(220)+0.61*r(223)+0.26*r(263)+0.585*r(301)+0.305*r(304)+0.65 &
                    *r(339)+0.5*r(342)+0.65*r(379)+0.61*r(382)+0.214*r(415)+0.506*r(422)+0.251*r(430)+0.251 &
                    *r(431)+0.251*r(432)+0.89*r(438)+0.35*r(445)+0.14*r(446)+0.315*r(447)+0.35*r(448)+0.35 &
                    *r(449)+0.89*r(458)+1.5*r(467)+r(469)+0.425*r(470)+0.599*r(472)+0.855*r(473)+0.855*r(474)
  yp(iACD)       = -r(12)-r(115)+r(135)+0.184*r(136)+0.01*r(152)+0.457*r(153)+0.1*r(159)+0.420*r(160) &
                    -r(173)+r(197)+0.504*r(198)+0.045*r(199)+0.012*r(202)+0.81*r(203)+0.75*r(278)+r(316) &
                    +r(356)+0.519*r(357)+0.048*r(358)+0.02*r(361)+0.85*r(362)
  yp(iMO2)       = +r(12)+r(14)+0.50*r(16)+0.325*r(19)+0.4*r(20)+r(30)+r(33)+0.48*r(50)+r(96)+0.65*r(138)+0.64 &
                    *r(144)+0.08*r(152)+0.32*r(153)+0.03*r(154)+0.08*r(155)+0.008*r(160)-r(196)+0.131 &
                    *r(198)+0.051*r(199)+r(215)+r(220)-r(239)+0.44*r(258)+0.26*r(263)-r(277)-r(277)-r(278) &
                    -r(279)+0.080*r(279)-r(280)+0.018*r(280)-r(281)-r(282)-r(283)-r(284)-r(285)-r(286) &
                    -r(287)-r(288)-r(289)-r(290)-r(291)-r(292)-r(293)-r(294)-r(295)-r(296)+0.9*r(296) &
                    -r(297)+0.9*r(297)-r(298)-r(299)-r(300)-r(301)+0.585*r(301)-r(302)-r(303)-r(304)-r(305) &
                    -r(306)-r(307)-r(308)-r(309)-r(310)-r(311)-r(312)-r(313)-r(314)-r(315)+0.5*r(316)+0.580 &
                    *r(317)+0.518*r(318)+0.500*r(319)+0.5*r(320)+0.500*r(321)+0.500*r(322)+r(323)+r(324) &
                    +r(325)+r(326)+r(327)+r(328)+r(329)+r(330)+0.5*r(331)+0.5*r(332)+0.5*r(333)+2.0*r(334) &
                    +r(335)+0.50*r(336)+0.50*r(337)+0.50*r(338)+1.65*r(339)+0.5*r(340)+0.9*r(341)+0.5 &
                    *r(342)+r(343)+r(344)+r(345)+r(346)+r(347)+r(348)+r(349)+0.500*r(350)+0.500*r(351) &
                    +r(352)+r(353)-r(355)+0.140*r(357)+0.055*r(358)+r(374)+0.65*r(379)-r(418)+r(419)-r(425)+0.936 &
                    *r(426)-r(442)+r(443)-r(447)+r(448)-r(454)+0.952*r(455)-r(461)+r(462)-r(472)+0.986*r(473)
  yp(iALD)       = -r(13)+0.434*r(15)+r(29)+0.20*r(31)+0.058*r(49)+0.025*r(100)-r(116)+0.40*r(126)+r(132)+0.719 &
                    *r(136)+r(137)+0.08*r(139)+0.44*r(152)+0.73*r(153)+0.65*r(156)-r(174)+0.132*r(198)+0.203 &
                    *r(199)+0.163*r(200)+0.2*r(201)+0.44*r(202)+0.68*r(203)+0.43*r(213)+0.452*r(219)+0.27 &
                    *r(223)+1.24*r(232)+1.24*r(233)+0.198*r(279)+0.251*r(280)+0.197*r(281)+0.15*r(282)+0.705 &
                    *r(283)+1.28*r(284)+0.023*r(293)+0.750*r(294)+0.203*r(304)+0.930*r(311)+0.930*r(313)+0.273 &
                    *r(317)+0.381*r(318)+0.217*r(319)+0.2*r(320)+0.940*r(321)+1.71*r(322)+r(332)+0.27 &
                    *r(342)+1.24*r(350)+1.24*r(351)+0.147*r(357)+0.241*r(358)+0.203*r(359)+0.2*r(360)+0.47 &
                    *r(361)+0.72*r(362)+0.031*r(371)+r(372)+0.27*r(382)+1.24*r(390)+1.24*r(391)+0.64*r(395)+0.640 &
                    *r(396)+1.21*r(398)+1.21*r(399)+1.21*r(400)+0.64*r(401)+0.640*r(402)+0.35*r(445)+0.14 &
                    *r(446)+0.315*r(447)+0.35*r(448)+0.35*r(449)+r(459)+0.7*r(461)+r(462)+r(463)+0.5*r(467)
  yp(iETHP)      = +r(13)+0.50*r(16)+r(17)+r(97)+0.06*r(152)+0.07*r(153)+0.20*r(156)+0.16*r(157)-r(197)+0.500 &
                    *r(198)+0.231*r(199)+0.145*r(200)+r(216)-r(240)+0.44*r(259)-r(278)+0.026*r(279)+0.140 &
                    *r(280)+0.090*r(281)-r(316)+0.026*r(317)+0.140*r(318)+0.067*r(319)+r(335)+2.0*r(354) &
                    -r(356)+0.503*r(357)+0.280*r(358)+0.180*r(359)+r(375)+r(404)
  yp(iACT)       = -r(14)-r(117)+0.03*r(152)+0.11*r(153)+0.165*r(198)+0.217*r(199)+0.06*r(202)+0.20*r(203)+0.11 &
                    *r(213)+0.095*r(357)+0.247*r(358)+0.09*r(361)+0.20*r(362)
  yp(iACO3)      = +r(14)+0.784*r(15)+r(16)+r(17)+r(18)+0.175*r(19)+0.4*r(20)+r(24)+0.25*r(25)+0.25*r(26) &
                    +r(32)+r(44)+0.26*r(48)+r(51)+r(54)+r(55)+0.7*r(56)+r(58)+r(115)+0.313*r(123)+r(125)+0.65 &
                    *r(145)+0.09*r(153)+0.15*r(154)+0.1*r(155)+0.098*r(158)+0.28*r(159)+0.002*r(160)+r(173) &
                    +r(178)-r(190)+r(191)-r(215)+r(217)+0.226*r(219)+0.625*r(222)-r(258)+0.150*r(260)+0.14 &
                    *r(263)+0.469*r(265)-r(296)+0.50*r(298)+0.315*r(301)+0.35*r(303)-r(316)-r(317)-r(318) &
                    -r(319)-r(320)-r(321)-r(322)-r(323)-r(324)-r(325)-r(326)-r(327)-r(328)-r(329)-r(330) &
                    -r(331)-r(332)-r(333)-r(334)-r(334)-r(335)-r(336)+0.50*r(336)-r(337)-r(338)-r(339)+0.35 &
                    *r(339)-r(340)-r(341)+0.63*r(341)-r(342)-r(343)-r(344)-r(345)-r(346)-r(347)-r(348) &
                    -r(349)-r(350)-r(351)-r(352)-r(353)-r(374)+r(376)+0.35*r(379)+0.7*r(381)-r(419)-r(426)+0.231 &
                    *r(438)-r(443)-r(448)-r(455)+0.214*r(458)-r(462)+r(468)-r(473)
  yp(iUALD)      = -r(15)+r(35)+r(38)-r(123)-r(160)-r(176)+0.491*r(214)+r(411)
  yp(iKET)       = +0.216*r(15)-r(17)+0.80*r(31)+r(34)+r(37)+r(39)-r(119)+0.78*r(126)+0.41*r(139)+0.017 &
                    *r(153)+0.53*r(156)+0.028*r(160)+0.039*r(199)+0.698*r(200)+0.09*r(203)+0.44*r(213)+0.289 &
                    *r(214)+0.7*r(223)+0.464*r(232)+0.464*r(233)+0.497*r(279)+0.618*r(280)+0.652*r(281)+0.045 &
                    *r(283)+0.218*r(284)+0.750*r(294)+0.525*r(304)+0.348*r(311)+0.348*r(313)+0.662*r(317)+0.824 &
                    *r(318)+0.642*r(319)+0.060*r(321)+0.290*r(322)+r(332)+0.7*r(342)+0.464*r(350)+0.464 &
                    *r(351)+0.060*r(358)+0.869*r(359)+0.11*r(362)+r(372)+0.7*r(382)+0.464*r(390)+0.464 &
                    *r(391)+0.149*r(395)+0.149*r(396)+0.285*r(398)+0.285*r(399)+0.285*r(400)+0.149*r(401)+0.149 &
                    *r(402)+0.3*r(475)
  yp(iMEK)       = -r(16)-r(118)+0.13*r(127)+0.06*r(152)+0.042*r(198)+0.033*r(199)+0.13*r(202)+0.075 &
                    *r(357)+0.063*r(358)+0.18*r(361)
  yp(iHKET)      = -r(18)+r(36)+r(46)+0.024*r(100)-r(120)+r(148)+r(150)+0.01*r(152)+0.044*r(153)+0.272 &
                    *r(199)+0.02*r(203)+r(221)+0.32*r(226)+0.016*r(293)+0.50*r(302)+0.25*r(303)+0.32*r(307)+0.5 &
                    *r(340)+0.1*r(341)+0.32*r(345)+0.275*r(358)+0.04*r(362)+0.033*r(371)+r(380)+0.32*r(385) &
                    +r(409)+r(412)+0.34*r(416)+0.235*r(418)+0.336*r(419)+0.336*r(420)+r(435)+0.328*r(472)+0.014 &
                    *r(473)
  yp(iMACR)      = -r(19)+0.25*r(43)-r(121)+0.39*r(154)+0.461*r(155)+0.79*r(157)-r(158)+0.90*r(169)-r(175)+0.26 &
                    *r(212)+0.047*r(255)+0.159*r(293)+0.308*r(295)+0.219*r(331)+0.308*r(333)+0.318*r(371)+0.615 &
                    *r(373)
  yp(iMACP)      = +0.5*r(19)+0.53*r(121)+0.21*r(128)+r(142)+0.1*r(155)+r(175)+r(176)+r(183)-r(194)+r(195) &
                    -r(220)-r(263)-r(301)-r(339)-r(379)
  yp(iMVK)       = -r(20)+0.44*r(43)-r(122)+0.189*r(155)-r(159)+0.4*r(212)+0.073*r(255)+0.250*r(293)+0.305 &
                    *r(331)+0.500*r(371)
  yp(iOLT)       = +0.6*r(20)-r(102)-r(152)+0.35*r(154)+0.153*r(155)+0.46*r(157)-r(167)
  yp(iGLY)       = -r(21)-r(22)-r(23)+0.5*r(25)+0.5*r(26)+0.25*r(42)+0.307*r(49)+0.48*r(50)+0.650*r(105) &
                    -r(124)+0.10*r(126)+0.10*r(127)+0.27*r(128)+0.491*r(160)+0.05*r(161)+0.05*r(162)+0.48 &
                    *r(163)+r(164)-r(177)+r(181)+0.918*r(204)+0.350*r(211)+0.18*r(223)+0.68*r(226)+r(228) &
                    +r(234)+0.050*r(279)+0.600*r(285)+0.271*r(287)+0.368*r(292)+0.018*r(293)+0.135*r(304)+0.68 &
                    *r(307)+r(309)+0.7*r(314)+0.067*r(317)+0.600*r(323)+0.368*r(330)+0.18*r(342)+0.68 &
                    *r(345)+r(347)+0.7*r(352)+r(363)+0.368*r(370)+0.024*r(371)+0.18*r(382)+0.68*r(385) &
                    +r(387)+r(392)+0.231*r(415)+0.275*r(430)+0.275*r(431)+0.275*r(432)+0.266*r(438)+0.29 &
                    *r(440)+0.205*r(442)+0.29*r(443)+0.293*r(444)+0.48*r(452)+0.322*r(453)+0.24*r(454)+0.432 &
                    *r(455)+0.48*r(456)+0.555*r(458)+0.2*r(465)
  yp(iMGLY)      = -r(24)+0.5*r(25)+0.5*r(26)+0.5*r(42)+0.335*r(49)+0.3*r(56)+r(120)-r(125)+0.01*r(126)+0.01 &
                    *r(127)+0.01*r(128)+0.902*r(158)+0.545*r(159)+0.003*r(160)+0.08*r(161)+0.08*r(162) &
                    -r(178)+0.95*r(207)+0.95*r(210)+0.600*r(211)+0.531*r(219)+0.265*r(222)+0.21*r(223) &
                    +r(288)+r(291)+0.632*r(292)+0.15*r(303)+0.105*r(304)+r(326)+r(329)+0.632*r(330)+0.27 &
                    *r(341)+0.105*r(342)+0.50*r(366)+r(369)+0.632*r(370)+0.3*r(381)+0.21*r(382)+0.445 &
                    *r(415)+0.148*r(422)+0.275*r(430)+0.275*r(431)+0.275*r(432)+r(433)+0.503*r(438)+0.32 &
                    *r(440)+0.212*r(441)+0.222*r(442)+0.32*r(443)+0.317*r(444)+0.52*r(452)+0.348*r(453)+0.364 &
                    *r(454)+0.52*r(455)+0.52*r(456)+0.555*r(458)+r(464)+0.425*r(470)+0.073*r(472)+0.131 &
                    *r(473)+0.145*r(474)+0.07*r(476)+0.65*r(477)
  yp(iDCB1)      = -r(25)-r(126)-r(161)+0.70*r(162)+0.70*r(163)+0.95*r(207)+0.95*r(210)+0.700*r(211)+0.67 &
                    *r(218)+r(288)+r(291)+0.737*r(292)+0.334*r(299)+0.50*r(300)+r(326)+r(329)+0.737*r(330)+0.334 &
                    *r(337)+0.50*r(338)+0.50*r(366)+r(369)+0.737*r(370)+0.67*r(377)+r(378)
  yp(iXO2)       = +0.2*r(25)+0.2*r(26)+r(132)+0.07*r(139)+0.35*r(145)+r(146)+r(147)+r(150)+0.13*r(154)+0.10 &
                    *r(160)+0.60*r(161)+0.60*r(162)+0.089*r(198)+0.435*r(199)+0.452*r(200)+0.157*r(219) &
                    -r(235)-r(276)+0.026*r(279)+0.191*r(280)+0.281*r(281)-r(315)+0.026*r(317)+0.191*r(318)+0.208 &
                    *r(319)-r(353)+0.092*r(357)+0.485*r(358)+0.563*r(359)-r(403)-r(404)-r(405)-r(405)
  yp(iDCB2)      = -r(26)-r(127)-r(162)+0.28*r(184)+0.49*r(185)+0.224*r(186)+0.490*r(187)+0.224*r(188)+0.490 &
                    *r(189)+0.459*r(204)+0.95*r(206)+0.073*r(211)+0.459*r(285)+r(287)+r(290)+0.077*r(292)+0.459 &
                    *r(323)+r(325)+r(328)+0.077*r(330)+0.50*r(363)+r(365)+0.077*r(370)+r(410)
  yp(iBALD)      = -r(27)-r(129)+0.02*r(152)+0.85*r(164)+r(205)+0.95*r(207)+r(208)+r(286)+r(289)+r(324) &
                    +r(327)+r(364)+0.50*r(366)+r(367)
  yp(iCHO)       = +r(27)+0.07*r(130)+0.07*r(131)+0.4*r(179)+0.4*r(180)-r(237)-r(268)
  yp(iOP1)       = -r(28)-r(138)+r(239)
  yp(iOP2)       = -r(29)+0.78*r(127)+0.79*r(128)-r(139)+0.65*r(161)+0.65*r(162)+0.68*r(226)+r(234)+r(240) &
                    +r(241)+r(242)+r(243)+r(244)+r(245)+r(246)+r(247)+r(248)+r(249)+r(250)+r(251)+r(252) &
                    +r(253)+r(254)+r(256)+r(257)+0.850*r(260)+r(261)+r(262)+r(266)+r(267)+r(269)+r(270) &
                    +r(276)+0.68*r(307)+0.7*r(314)+0.68*r(345)+0.7*r(352)+0.68*r(385)+r(392)+r(460)+r(471)
  yp(iPAA)       = -r(30)-r(145)+0.11*r(163)+0.41*r(258)+0.41*r(259)
  yp(iONIT)      = -r(31)-r(149)+0.063*r(198)+0.114*r(199)+0.197*r(200)+r(229)
  yp(iPAN)       = -r(32)-r(33)-r(146)+r(190)-r(191)
  yp(iTONIT)     = -r(34)+0.12*r(213)+r(230)+0.7*r(271)+0.7*r(272)+0.7*r(310)+0.350*r(311)+0.7*r(348)+0.7 &
                    *r(388)+1.4*r(393)+0.7*r(395)+0.7*r(397)+0.7*r(398)+0.35*r(400)+0.35*r(401)+1.05*r(402) &
                    -r(406)
  yp(iUTONIT)    = -r(35)+0.06*r(213)+0.22*r(214)+0.3*r(271)+0.3*r(272)+0.3*r(310)+0.15*r(311)+0.3*r(348)+0.3 &
                    *r(388)+0.6*r(393)+0.3*r(395)+0.3*r(397)+0.3*r(398)+0.15*r(400)+0.15*r(401)+0.45*r(402) &
                    -r(407)-r(408)
  yp(iHONIT)     = -r(36)+r(406)+r(407)+r(408)-r(409)
  yp(iAONIT)     = -r(37)+0.082*r(204)+0.05*r(206)+0.050*r(207)+0.05*r(209)+0.050*r(210)+0.05*r(211) &
                    +r(236)+r(237)+r(238)+r(275)+0.3*r(314)+0.3*r(352)-r(410)
  yp(iDONIT)     = -r(38)+0.015*r(203)-r(411)
  yp(iMONIT)     = -r(39)+0.002*r(198)+0.022*r(199)+0.03*r(202)+0.035*r(203)+0.017*r(219)+r(231)+r(273) &
                    +r(274)+r(312)+0.500*r(313)+r(349)+r(389)+2.00*r(394)+0.5*r(395)+1.50*r(396)+r(397) &
                    +r(399)+0.5*r(400)+r(401)-r(412)
  yp(iISOPND)    = -r(40)+0.07*r(212)-r(414)-r(415)
  yp(iISOP)      = +r(40)+r(41)+r(111)+0.7*r(141)-r(212)-r(255)-r(293)-r(331)-r(371)-r(413)
  yp(iISOPNB)    = -r(41)+0.047*r(212)-r(421)-r(422)
  yp(iHPALD)     = -r(42)+r(413)-r(428)
  yp(iHAC)       = +0.5*r(42)+0.632*r(47)+0.24*r(48)+0.307*r(49)-r(51)+r(57)+0.058*r(214)+0.289*r(415)+0.44 &
                    *r(416)+0.309*r(418)+0.442*r(419)+0.442*r(420)+0.179*r(422)+0.6*r(423)+0.343*r(425)+0.562 &
                    *r(426)+0.6*r(427)+0.725*r(430)+0.725*r(431)+0.725*r(432)+0.266*r(438)+0.29*r(440)+0.205 &
                    *r(442)+0.29*r(443)+0.293*r(444)+0.48*r(452)+0.322*r(453)+0.24*r(454)+0.432*r(455)+0.48 &
                    *r(456)-r(464)+0.5*r(467)+r(469)+0.425*r(470)+0.599*r(472)+0.855*r(473)+0.855*r(474)+0.85 &
                    *r(476)
  yp(iGLYC)      = +0.25*r(42)+0.612*r(47)+0.26*r(48)+0.335*r(49)-r(52)+0.7*r(56)+r(58)+0.625*r(222)+0.469 &
                    *r(265)+0.35*r(303)+0.63*r(341)+0.7*r(381)+0.249*r(415)+0.15*r(416)+0.101*r(418)+0.144 &
                    *r(419)+0.144*r(420)+0.6*r(423)+0.343*r(425)+0.562*r(426)+0.6*r(427)+0.275*r(430)+0.275 &
                    *r(431)+0.275*r(432)+0.271*r(438)+0.32*r(440)+0.212*r(441)+0.222*r(442)+0.32*r(443)+0.317 &
                    *r(444)+0.52*r(452)+0.348*r(453)+0.364*r(454)+0.52*r(455)+0.52*r(456)-r(465)-r(466)
  yp(iISHP)      = -r(43)-r(140)-r(141)+0.88*r(255)
  yp(iUHC)       = +0.202*r(43)-r(48)+0.3*r(141)+0.143*r(212)-r(437)-r(438)-r(439)
  yp(iDIBOO)     = +0.108*r(43)+0.08*r(212)+0.34*r(451)-r(452)-r(453)-r(454)-r(455)-r(456)
  yp(iPROPNN)    = -r(44)+0.298*r(47)+0.266*r(415)+0.15*r(416)+0.101*r(418)+0.144*r(419)+0.144*r(420)-r(433)
  yp(iETHLN)     = -r(45)+0.318*r(47)+0.271*r(415)+0.13*r(416)+0.093*r(418)+0.133*r(419)+0.133*r(420)-r(434)
  yp(iIMONIT)    = -r(46)+0.018*r(415)+0.3*r(418)+0.112*r(422)+0.428*r(425)+0.064*r(426)-r(435)+0.443*r(436)
  yp(iISNP)      = -r(47)+r(417)+r(424)-r(436)
  yp(iMVKN)      = +0.07*r(47)-r(58)+0.11*r(222)+0.07*r(416)+0.055*r(418)+0.078*r(419)+0.078*r(420)+0.212 &
                    *r(422)+0.14*r(423)+0.101*r(425)+0.144*r(426)+0.144*r(427)-r(477)
  yp(iUHCAP)     = +0.5*r(48)+0.26*r(437)+r(439)-r(445)-r(446)-r(447)-r(448)-r(449)-r(450)+0.165*r(451)
  yp(iIAP)       = -r(49)+0.652*r(441)+0.4*r(446)-r(451)+0.33*r(453)
  yp(iMOBA)      = +0.107*r(49)-r(50)+0.65*r(445)+0.26*r(446)+0.585*r(447)+0.65*r(448)+0.65*r(449)-r(457) &
                    -r(458)
  yp(iDHMOB)     = +0.193*r(49)-r(53)+0.39*r(440)+0.136*r(441)+0.573*r(442)+0.39*r(443)+0.39*r(444)+0.396 &
                    *r(454)+0.048*r(455)-r(467)
  yp(iPYAC)      = +0.53*r(50)-r(54)+0.075*r(159)-r(468)+0.35*r(477)
  yp(iKETP)      = +r(53)+r(119)+0.02*r(154)+0.42*r(156)+0.42*r(157)-r(219)-r(262)-r(300)-r(338)-r(378)+0.231 &
                    *r(458)
  yp(iMAHP)      = -r(55)-r(142)+0.4*r(263)+r(264)
  yp(iVRP)       = -r(56)+0.531*r(265)-r(475)
  yp(iMACRN)     = -r(57)+0.349*r(422)+0.26*r(423)+0.128*r(425)+0.23*r(426)+0.256*r(427)+0.15*r(470)-r(476)
  yp(iN2O5)      = +r(88)-r(89)-r(90)
  yp(iSO2)       = -r(94)
  yp(iSULF)      = +r(94)
  yp(iCH4)       = -r(96)
  yp(iETH)       = -r(97)+0.02*r(152)+0.01*r(153)
  yp(iHC3)       = -r(98)+0.015*r(152)+0.01*r(153)
  yp(iHC3P)      = +r(98)+0.44*r(139)+r(149)+0.04*r(152)+0.04*r(153)-r(198)-r(241)-r(279)-r(317)-r(357)
  yp(iHC5)       = -r(99)+0.006*r(152)
  yp(iHC5P)      = +r(99)+0.02*r(152)-r(199)-r(242)-r(280)-r(318)-r(358)
  yp(iHC8)       = -r(100)
  yp(iHC8P)      = +0.951*r(100)-r(200)-r(243)-r(281)-r(319)-r(359)
  yp(iETE)       = -r(101)-r(151)-r(166)
  yp(iETEP)      = +r(101)-r(201)-r(244)-r(282)-r(320)-r(360)
  yp(iOLTP)      = +r(102)-r(202)-r(245)-r(283)-r(321)-r(361)
  yp(iOLI)       = -r(103)-r(153)-r(168)+0.289*r(214)+0.192*r(295)+0.192*r(333)+0.385*r(373)
  yp(iOLIP)      = +r(103)+r(104)-r(203)-r(246)-r(284)-r(322)-r(362)
  yp(iDIEN)      = -r(104)-r(154)-r(169)
  yp(iACE)       = -r(105)
  yp(iORA1)      = +0.350*r(105)-r(143)+0.37*r(151)+0.03*r(152)+0.15*r(154)+0.28*r(155)+0.01*r(157)+0.204 &
                    *r(158)+0.075*r(159)+0.044*r(160)+0.25*r(163)+0.07*r(213)+0.31*r(416)+0.216*r(418)+0.309 &
                    *r(419)+0.309*r(420)+0.068*r(422)+0.074*r(430)+0.074*r(431)+0.074*r(432)+0.07*r(476)+0.65 &
                    *r(477)
  yp(iBENZ)      = -r(106)+0.032*r(152)
  yp(iBENP)      = +0.352*r(106)-r(204)-r(247)-r(285)-r(323)-r(363)
  yp(iEPX)       = +0.118*r(106)-r(132)-r(164)-r(181)+0.28*r(184)+0.840*r(186)+0.840*r(188)
  yp(iPHEN)      = +0.530*r(106)-r(130)-r(179)
  yp(iBENZRO2)   = +1.0*r(106)
  yp(iTOL)       = -r(107)
  yp(iTR2)       = +0.763*r(107)-r(184)
  yp(iTLP1)      = +0.060*r(107)-r(205)-r(248)-r(286)-r(324)-r(364)
  yp(iCSL)       = +0.177*r(107)+0.177*r(108)+0.177*r(109)+0.177*r(110)-r(131)-r(180)+0.01*r(184)+0.01 &
                    *r(185)+0.010*r(186)+0.010*r(187)+0.010*r(188)+0.010*r(189)+r(268)
  yp(iTOLRO2)    = +1.0*r(107)
  yp(iXYM)       = -r(108)
  yp(iXY2)       = +0.763*r(108)+0.763*r(109)-r(186)
  yp(iXYL1)      = +0.060*r(108)+0.060*r(109)+0.060*r(110)-r(208)-r(251)-r(289)-r(327)-r(367)
  yp(iXYLRO2)    = +1.0*r(108)+1.0*r(109)+1.0*r(110)
  yp(iXYP)       = -r(109)
  yp(iXYO)       = -r(110)
  yp(iXYO2)      = +0.763*r(110)-r(188)
  yp(iISO)       = -r(111)-r(155)
  yp(iAPI)       = -r(112)-r(156)-r(170)
  yp(iAPIP)      = +r(112)-r(213)-r(256)-r(294)-r(332)-r(372)
  yp(iLIM)       = -r(113)-r(157)-r(171)
  yp(iLIMP)      = +r(113)-r(214)-r(257)-r(295)-r(333)-r(373)
  yp(iRCO3)      = +r(116)+0.60*r(161)+0.60*r(162)+r(174)+0.250*r(186)+0.250*r(188)-r(192)+r(193)-r(216) &
                    -r(259)-r(297)-r(335)-r(354)-r(354)-r(375)-r(404)+0.8*r(465)+r(466)
  yp(iACTP)      = +r(117)-r(217)-r(260)-r(298)-r(336)-r(376)
  yp(iMEKP)      = +r(118)-r(218)-r(261)-r(299)-r(337)-r(377)
  yp(iMACRO2)    = +0.47*r(121)-r(469)-r(470)-r(471)-r(472)-r(473)-r(474)
  yp(iMVKP)      = +r(122)-r(222)-r(265)-r(303)-r(341)-r(381)+0.7*r(475)
  yp(iUALP)      = +0.687*r(123)-r(223)-r(266)-r(304)-r(342)-r(382)
  yp(iDCB3)      = -r(128)-r(163)+0.459*r(204)+0.95*r(209)+1.05*r(210)+0.177*r(211)+0.459*r(285)+1.05 &
                    *r(291)+0.186*r(292)+0.458*r(323)+1.05*r(329)+0.186*r(330)+0.50*r(363)+r(368)+1.05 &
                    *r(369)+0.186*r(370)
  yp(iBALP)      = +r(129)-r(224)-r(305)-r(343)-r(383)
  yp(iADDC)      = +0.20*r(130)+0.20*r(131)+0.1*r(179)+0.1*r(180)-r(226)-r(267)-r(307)-r(345)-r(385)
  yp(iMCT)       = +0.73*r(130)+0.73*r(131)-r(133)-r(182)
  yp(iMCTO)      = +r(133)-r(165)+r(182)+r(227)-r(238)+r(308)+r(346)+r(386)
  yp(iMOH)       = -r(134)+0.63*r(277)+0.250*r(278)+0.250*r(279)+0.250*r(280)+0.250*r(281)+0.250*r(282)+0.250 &
                    *r(283)+0.250*r(284)+0.250*r(293)+0.250*r(294)+0.250*r(295)+0.25*r(298)+0.25*r(299)+0.25 &
                    *r(300)+0.250*r(302)+0.25*r(303)+0.250*r(304)+0.250*r(311)+0.250*r(313)+0.16*r(425)+0.018 &
                    *r(438)+0.12*r(454)+0.036*r(472)
  yp(iEOH)       = -r(135)+0.250*r(278)
  yp(iROH)       = -r(136)+0.250*r(279)+0.250*r(280)+0.250*r(281)+0.250*r(283)+0.250*r(284)+0.250*r(293)+0.250 &
                    *r(294)+0.250*r(295)+0.25*r(298)+0.25*r(299)+0.25*r(300)+0.250*r(302)+0.25*r(303)+0.250 &
                    *r(304)+0.25*r(311)+0.25*r(313)+0.3*r(461)
  yp(iETEG)      = -r(137)+0.250*r(282)
  yp(iIEPOX)     = +r(140)-r(429)
  yp(iORA2)      = -r(144)+0.06*r(152)+0.017*r(153)+0.07*r(157)+0.25*r(163)+0.15*r(258)+0.15*r(259)+0.2 &
                    *r(263)+0.1*r(296)+0.1*r(297)+0.125*r(298)+0.1*r(301)+0.5*r(316)+0.500*r(317)+0.500 &
                    *r(318)+0.495*r(319)+0.5*r(320)+0.500*r(321)+0.500*r(322)+0.5*r(331)+r(332)+0.5*r(333)+0.75 &
                    *r(336)+0.50*r(337)+0.50*r(338)+0.5*r(340)+0.1*r(341)+0.5*r(342)+0.500*r(350)+0.500 &
                    *r(351)+0.017*r(415)+0.064*r(426)+0.2*r(446)+0.1*r(447)+0.048*r(455)+0.014*r(473)+0.08 &
                    *r(476)
  yp(iORAP)      = +0.36*r(144)-r(228)-r(270)-r(309)-r(347)-r(387)
  yp(iPPN)       = -r(147)+r(192)-r(193)
  yp(iMPAN)      = -r(148)-r(183)+r(194)-r(195)+r(450)
  yp(iNALD)      = -r(150)
  yp(iMCTP)      = +r(165)-r(227)-r(269)-r(308)-r(346)-r(386)
  yp(iOLNN)      = +0.80*r(166)+0.43*r(167)+0.11*r(168)+0.90*r(169)-r(229)-r(231)-r(273)-r(312)-r(349) &
                    -r(389)-r(394)-r(394)-r(396)-r(397)-r(401)
  yp(iOLND)      = +0.20*r(166)+0.57*r(167)+0.89*r(168)+0.10*r(169)-r(232)-r(274)-r(313)-r(350)-r(390) &
                    -r(395)-r(396)-r(399)-r(399)-r(400)
  yp(iTOLNN)     = +0.10*r(170)+0.71*r(171)-r(230)-r(271)-r(310)-r(348)-r(388)-r(393)-r(393)-r(395)-r(397) &
                    -r(402)
  yp(iTOLND)     = +0.90*r(170)+0.29*r(171)-r(233)-r(272)-r(311)-r(351)-r(391)-r(398)-r(398)-r(400)-r(401) &
                    -r(402)
  yp(iADCN)      = +0.5*r(179)+0.5*r(180)-r(234)-r(275)-r(314)-r(352)-r(392)
  yp(iTOLP)      = +0.28*r(184)-r(185)-r(206)-r(249)-r(287)-r(325)-r(365)
  yp(iPER1)      = +0.15*r(184)+0.50*r(185)-r(207)-r(250)-r(288)-r(326)-r(366)
  yp(iXYLP)      = +0.308*r(186)-r(187)-r(209)-r(252)-r(290)-r(328)-r(368)
  yp(iPER2)      = +0.150*r(186)+0.300*r(187)+0.150*r(188)+0.500*r(189)-r(210)-r(253)-r(291)-r(329)-r(369)
  yp(iXYOP)      = +0.308*r(188)-r(189)-r(211)-r(254)-r(292)-r(330)-r(370)
  yp(iMCP)       = -r(221)-r(264)-r(302)-r(340)-r(380)
  yp(iBAL1)      = +r(224)-r(225)+r(305)-r(306)+r(343)-r(344)+r(383)-r(384)
  yp(iBAL2)      = +r(225)-r(236)+r(306)+r(344)+r(384)
  yp(iISOPNDO2)  = +r(414)-r(416)-r(417)-r(418)-r(419)-r(420)+0.460*r(436)
  yp(iISOPNBO2)  = +r(421)-r(423)-r(424)-r(425)-r(426)-r(427)+0.097*r(436)
  yp(iIEPOXOO)   = +r(429)-r(430)-r(431)-r(432)
  yp(iUHCP)      = +0.74*r(437)-r(440)-r(441)-r(442)-r(443)-r(444)+0.495*r(451)
  yp(iMOBAOO)    = +r(457)-r(459)-r(460)-r(461)-r(462)-r(463)

  return
end subroutine fgaschem

!**********************************************************************************************************************!
! RxnRates - calculates instantaneous values of the reaction rates
!            (molecules/cm3-s)
!**********************************************************************************************************************!
subroutine RxnRates(neqn,k,y,r)
  integer(kind=i4) :: neqn
  real(kind=dp), dimension(nrxn) :: k
  real(kind=dp), dimension(nrxn) :: r
  real(kind=dp), dimension(neqn) :: y
  real(kind=dp) :: H2, O2, N2, H2Oz
 
  ! non-integrated species concentrations
  H2 = 500.0E-9*cair(zpt)        ! molecular hydrogen
  O2 = 0.21*cair(zpt)            ! diatomic oxygen
  N2 = 0.78*cair(zpt)            ! diatomic nitrogen
  H2Oz = h2o(zpt)                ! water vapor

  ! Generated by chmgen for mechanism racm2_plus
  r(1)     = k(1)*y(iO3)
  r(2)     = k(2)*y(iO3)
  r(3)     = k(3)*y(iH2O2)
  r(4)     = k(4)*y(iNO2)
  r(5)     = k(5)*y(iNO3)
  r(6)     = k(6)*y(iNO3)
  r(7)     = k(7)*y(iHONO)
  r(8)     = k(8)*y(iHNO3)
  r(9)     = k(9)*y(iHNO4)
  r(10)    = k(10)*y(iHCHO)
  r(11)    = k(11)*y(iHCHO)
  r(12)    = k(12)*y(iACD)
  r(13)    = k(13)*y(iALD)
  r(14)    = k(14)*y(iACT)
  r(15)    = k(15)*y(iUALD)
  r(16)    = k(16)*y(iMEK)
  r(17)    = k(17)*y(iKET)
  r(18)    = k(18)*y(iHKET)
  r(19)    = k(19)*y(iMACR)
  r(20)    = k(20)*y(iMVK)
  r(21)    = k(21)*y(iGLY)
  r(22)    = k(22)*y(iGLY)
  r(23)    = k(23)*y(iGLY)
  r(24)    = k(24)*y(iMGLY)
  r(25)    = k(25)*y(iDCB1)
  r(26)    = k(26)*y(iDCB2)
  r(27)    = k(27)*y(iBALD)
  r(28)    = k(28)*y(iOP1)
  r(29)    = k(29)*y(iOP2)
  r(30)    = k(30)*y(iPAA)
  r(31)    = k(31)*y(iONIT)
  r(32)    = k(32)*y(iPAN)
  r(33)    = k(33)*y(iPAN)
  r(34)    = k(34)*y(iTONIT)
  r(35)    = k(35)*y(iUTONIT)
  r(36)    = k(36)*y(iHONIT)
  r(37)    = k(37)*y(iAONIT)
  r(38)    = k(38)*y(iDONIT)
  r(39)    = k(39)*y(iMONIT)
  r(40)    = k(40)*y(iISOPND)
  r(41)    = k(41)*y(iISOPNB)
  r(42)    = k(42)*y(iHPALD)
  r(43)    = k(43)*y(iISHP)
  r(44)    = k(44)*y(iPROPNN)
  r(45)    = k(45)*y(iETHLN)
  r(46)    = k(46)*y(iIMONIT)
  r(47)    = k(47)*y(iISNP)
  r(48)    = k(48)*y(iUHC)
  r(49)    = k(49)*y(iIAP)
  r(50)    = k(50)*y(iMOBA)
  r(51)    = k(51)*y(iHAC)
  r(52)    = k(52)*y(iGLYC)
  r(53)    = k(53)*y(iDHMOB)
  r(54)    = k(54)*y(iPYAC)
  r(55)    = k(55)*y(iMAHP)
  r(56)    = k(56)*y(iVRP)
  r(57)    = k(57)*y(iMACRN)
  r(58)    = k(58)*y(iMVKN)
  r(59)    = k(59)*y(iO3)*y(iHO)
  r(60)    = k(60)*y(iO3)*y(iHO2)
  r(61)    = k(61)*y(iO3)*y(iNO)
  r(62)    = k(62)*y(iO3)*y(iNO2)
  r(63)    = k(63)*y(iO3P)
  r(64)    = k(64)*y(iO3P)*y(iO3)
  r(65)    = k(65)*y(iO1D)*O2
  r(66)    = k(66)*y(iO1D)*N2
  r(67)    = k(67)*y(iO1D)
  r(68)    = k(68)*H2*y(iHO)
  r(69)    = k(69)*y(iHO)*y(iHO2)
  r(70)    = k(70)*y(iHO2)*y(iHO2)
  r(71)    = k(71)*y(iHO2)*y(iHO2)
  r(72)    = k(72)*y(iH2O2)*y(iHO)
  r(73)    = k(73)*y(iNO)*y(iO3P)
  r(74)    = k(74)*y(iNO)*y(iHO)
  r(75)    = k(75)*y(iNO)*y(iHO2)
  r(76)    = k(76)*y(iNO)*y(iHO2)
  r(77)    = k(77)*y(iNO)*y(iNO)*O2
  r(78)    = k(78)*y(iHONO)*y(iHO)
  r(79)    = k(79)*y(iNO2)*y(iO3P)
  r(80)    = k(80)*y(iNO2)*y(iO3P)
  r(81)    = k(81)*y(iNO2)*y(iHO)
  r(82)    = k(82)*y(iHNO3)*y(iHO)
  r(83)    = k(83)*y(iNO3)*y(iHO)
  r(84)    = k(84)*y(iNO3)*y(iHO2)
  r(85)    = k(85)*y(iNO3)*y(iNO)
  r(86)    = k(86)*y(iNO3)*y(iNO2)
  r(87)    = k(87)*y(iNO3)*y(iNO3)
  r(88)    = k(88)*y(iNO3)*y(iNO2)
  r(89)    = k(89)*y(iN2O5)
  r(90)    = k(90)*y(iN2O5)
  r(91)    = k(91)*y(iNO2)*y(iHO2)
  r(92)    = k(92)*y(iHNO4)
  r(93)    = k(93)*y(iHNO4)*y(iHO)
  r(94)    = k(94)*y(iSO2)*y(iHO)
  r(95)    = k(95)*y(iCO)*y(iHO)
  r(96)    = k(96)*y(iCH4)*y(iHO)
  r(97)    = k(97)*y(iETH)*y(iHO)
  r(98)    = k(98)*y(iHC3)*y(iHO)
  r(99)    = k(99)*y(iHC5)*y(iHO)
  r(100)   = k(100)*y(iHC8)*y(iHO)
  r(101)   = k(101)*y(iETE)*y(iHO)
  r(102)   = k(102)*y(iOLT)*y(iHO)
  r(103)   = k(103)*y(iOLI)*y(iHO)
  r(104)   = k(104)*y(iDIEN)*y(iHO)
  r(105)   = k(105)*y(iACE)*y(iHO)
  r(106)   = k(106)*y(iBENZ)*y(iHO)
  r(107)   = k(107)*y(iTOL)*y(iHO)
  r(108)   = k(108)*y(iXYM)*y(iHO)
  r(109)   = k(109)*y(iXYP)*y(iHO)
  r(110)   = k(110)*y(iXYO)*y(iHO)
  r(111)   = k(111)*y(iISO)*y(iHO)
  r(112)   = k(112)*y(iAPI)*y(iHO)
  r(113)   = k(113)*y(iLIM)*y(iHO)
  r(114)   = k(114)*y(iHCHO)*y(iHO)
  r(115)   = k(115)*y(iACD)*y(iHO)
  r(116)   = k(116)*y(iALD)*y(iHO)
  r(117)   = k(117)*y(iACT)*y(iHO)
  r(118)   = k(118)*y(iMEK)*y(iHO)
  r(119)   = k(119)*y(iKET)*y(iHO)
  r(120)   = k(120)*y(iHKET)*y(iHO)
  r(121)   = k(121)*y(iMACR)*y(iHO)
  r(122)   = k(122)*y(iMVK)*y(iHO)
  r(123)   = k(123)*y(iUALD)*y(iHO)
  r(124)   = k(124)*y(iGLY)*y(iHO)
  r(125)   = k(125)*y(iMGLY)*y(iHO)
  r(126)   = k(126)*y(iDCB1)*y(iHO)
  r(127)   = k(127)*y(iDCB2)*y(iHO)
  r(128)   = k(128)*y(iDCB3)*y(iHO)
  r(129)   = k(129)*y(iBALD)*y(iHO)
  r(130)   = k(130)*y(iPHEN)*y(iHO)
  r(131)   = k(131)*y(iCSL)*y(iHO)
  r(132)   = k(132)*y(iEPX)*y(iHO)
  r(133)   = k(133)*y(iMCT)*y(iHO)
  r(134)   = k(134)*y(iMOH)*y(iHO)
  r(135)   = k(135)*y(iEOH)*y(iHO)
  r(136)   = k(136)*y(iROH)*y(iHO)
  r(137)   = k(137)*y(iETEG)*y(iHO)
  r(138)   = k(138)*y(iOP1)*y(iHO)
  r(139)   = k(139)*y(iOP2)*y(iHO)
  r(140)   = k(140)*y(iISHP)*y(iHO)
  r(141)   = k(141)*y(iISHP)*y(iHO)
  r(142)   = k(142)*y(iMAHP)*y(iHO)
  r(143)   = k(143)*y(iORA1)*y(iHO)
  r(144)   = k(144)*y(iORA2)*y(iHO)
  r(145)   = k(145)*y(iPAA)*y(iHO)
  r(146)   = k(146)*y(iPAN)*y(iHO)
  r(147)   = k(147)*y(iPPN)*y(iHO)
  r(148)   = k(148)*y(iMPAN)*y(iHO)
  r(149)   = k(149)*y(iONIT)*y(iHO)
  r(150)   = k(150)*y(iNALD)*y(iHO)
  r(151)   = k(151)*y(iETE)*y(iO3)
  r(152)   = k(152)*y(iOLT)*y(iO3)
  r(153)   = k(153)*y(iOLI)*y(iO3)
  r(154)   = k(154)*y(iDIEN)*y(iO3)
  r(155)   = k(155)*y(iISO)*y(iO3)
  r(156)   = k(156)*y(iAPI)*y(iO3)
  r(157)   = k(157)*y(iLIM)*y(iO3)
  r(158)   = k(158)*y(iMACR)*y(iO3)
  r(159)   = k(159)*y(iMVK)*y(iO3)
  r(160)   = k(160)*y(iUALD)*y(iO3)
  r(161)   = k(161)*y(iDCB1)*y(iO3)
  r(162)   = k(162)*y(iDCB2)*y(iO3)
  r(163)   = k(163)*y(iDCB3)*y(iO3)
  r(164)   = k(164)*y(iEPX)*y(iO3)
  r(165)   = k(165)*y(iMCTO)*y(iO3)
  r(166)   = k(166)*y(iETE)*y(iNO3)
  r(167)   = k(167)*y(iOLT)*y(iNO3)
  r(168)   = k(168)*y(iOLI)*y(iNO3)
  r(169)   = k(169)*y(iDIEN)*y(iNO3)
  r(170)   = k(170)*y(iAPI)*y(iNO3)
  r(171)   = k(171)*y(iLIM)*y(iNO3)
  r(172)   = k(172)*y(iHCHO)*y(iNO3)
  r(173)   = k(173)*y(iACD)*y(iNO3)
  r(174)   = k(174)*y(iALD)*y(iNO3)
  r(175)   = k(175)*y(iMACR)*y(iNO3)
  r(176)   = k(176)*y(iUALD)*y(iNO3)
  r(177)   = k(177)*y(iGLY)*y(iNO3)
  r(178)   = k(178)*y(iMGLY)*y(iNO3)
  r(179)   = k(179)*y(iPHEN)*y(iNO3)
  r(180)   = k(180)*y(iCSL)*y(iNO3)
  r(181)   = k(181)*y(iEPX)*y(iNO3)
  r(182)   = k(182)*y(iMCT)*y(iNO3)
  r(183)   = k(183)*y(iMPAN)*y(iNO3)
  r(184)   = k(184)*y(iTR2)
  r(185)   = k(185)*y(iTOLP)
  r(186)   = k(186)*y(iXY2)
  r(187)   = k(187)*y(iXYLP)
  r(188)   = k(188)*y(iXYO2)
  r(189)   = k(189)*y(iXYOP)
  r(190)   = k(190)*y(iACO3)*y(iNO2)
  r(191)   = k(191)*y(iPAN)
  r(192)   = k(192)*y(iRCO3)*y(iNO2)
  r(193)   = k(193)*y(iPPN)
  r(194)   = k(194)*y(iMACP)*y(iNO2)
  r(195)   = k(195)*y(iMPAN)
  r(196)   = k(196)*y(iMO2)*y(iNO)
  r(197)   = k(197)*y(iETHP)*y(iNO)
  r(198)   = k(198)*y(iHC3P)*y(iNO)
  r(199)   = k(199)*y(iHC5P)*y(iNO)
  r(200)   = k(200)*y(iHC8P)*y(iNO)
  r(201)   = k(201)*y(iETEP)*y(iNO)
  r(202)   = k(202)*y(iOLTP)*y(iNO)
  r(203)   = k(203)*y(iOLIP)*y(iNO)
  r(204)   = k(204)*y(iBENP)*y(iNO)
  r(205)   = k(205)*y(iTLP1)*y(iNO)
  r(206)   = k(206)*y(iTOLP)*y(iNO)
  r(207)   = k(207)*y(iPER1)*y(iNO)
  r(208)   = k(208)*y(iXYL1)*y(iNO)
  r(209)   = k(209)*y(iXYLP)*y(iNO)
  r(210)   = k(210)*y(iPER2)*y(iNO)
  r(211)   = k(211)*y(iXYOP)*y(iNO)
  r(212)   = k(212)*y(iISOP)*y(iNO)
  r(213)   = k(213)*y(iAPIP)*y(iNO)
  r(214)   = k(214)*y(iLIMP)*y(iNO)
  r(215)   = k(215)*y(iACO3)*y(iNO)
  r(216)   = k(216)*y(iRCO3)*y(iNO)
  r(217)   = k(217)*y(iACTP)*y(iNO)
  r(218)   = k(218)*y(iMEKP)*y(iNO)
  r(219)   = k(219)*y(iKETP)*y(iNO)
  r(220)   = k(220)*y(iMACP)*y(iNO)
  r(221)   = k(221)*y(iMCP)*y(iNO)
  r(222)   = k(222)*y(iMVKP)*y(iNO)
  r(223)   = k(223)*y(iUALP)*y(iNO)
  r(224)   = k(224)*y(iBALP)*y(iNO)
  r(225)   = k(225)*y(iBAL1)*y(iNO)
  r(226)   = k(226)*y(iADDC)*y(iNO)
  r(227)   = k(227)*y(iMCTP)*y(iNO)
  r(228)   = k(228)*y(iORAP)*y(iNO)
  r(229)   = k(229)*y(iOLNN)*y(iNO)
  r(230)   = k(230)*y(iTOLNN)*y(iNO)
  r(231)   = k(231)*y(iOLNN)*y(iNO)
  r(232)   = k(232)*y(iOLND)*y(iNO)
  r(233)   = k(233)*y(iTOLND)*y(iNO)
  r(234)   = k(234)*y(iADCN)*y(iNO)
  r(235)   = k(235)*y(iXO2)*y(iNO)
  r(236)   = k(236)*y(iBAL2)*y(iNO2)
  r(237)   = k(237)*y(iCHO)*y(iNO2)
  r(238)   = k(238)*y(iMCTO)*y(iNO2)
  r(239)   = k(239)*y(iMO2)*y(iHO2)
  r(240)   = k(240)*y(iETHP)*y(iHO2)
  r(241)   = k(241)*y(iHC3P)*y(iHO2)
  r(242)   = k(242)*y(iHC5P)*y(iHO2)
  r(243)   = k(243)*y(iHC8P)*y(iHO2)
  r(244)   = k(244)*y(iETEP)*y(iHO2)
  r(245)   = k(245)*y(iOLTP)*y(iHO2)
  r(246)   = k(246)*y(iOLIP)*y(iHO2)
  r(247)   = k(247)*y(iBENP)*y(iHO2)
  r(248)   = k(248)*y(iTLP1)*y(iHO2)
  r(249)   = k(249)*y(iTOLP)*y(iHO2)
  r(250)   = k(250)*y(iPER1)*y(iHO2)
  r(251)   = k(251)*y(iXYL1)*y(iHO2)
  r(252)   = k(252)*y(iXYLP)*y(iHO2)
  r(253)   = k(253)*y(iPER2)*y(iHO2)
  r(254)   = k(254)*y(iXYOP)*y(iHO2)
  r(255)   = k(255)*y(iISOP)*y(iHO2)
  r(256)   = k(256)*y(iAPIP)*y(iHO2)
  r(257)   = k(257)*y(iLIMP)*y(iHO2)
  r(258)   = k(258)*y(iACO3)*y(iHO2)
  r(259)   = k(259)*y(iRCO3)*y(iHO2)
  r(260)   = k(260)*y(iACTP)*y(iHO2)
  r(261)   = k(261)*y(iMEKP)*y(iHO2)
  r(262)   = k(262)*y(iKETP)*y(iHO2)
  r(263)   = k(263)*y(iMACP)*y(iHO2)
  r(264)   = k(264)*y(iMCP)*y(iHO2)
  r(265)   = k(265)*y(iMVKP)*y(iHO2)
  r(266)   = k(266)*y(iUALP)*y(iHO2)
  r(267)   = k(267)*y(iADDC)*y(iHO2)
  r(268)   = k(268)*y(iCHO)*y(iHO2)
  r(269)   = k(269)*y(iMCTP)*y(iHO2)
  r(270)   = k(270)*y(iORAP)*y(iHO2)
  r(271)   = k(271)*y(iTOLNN)*y(iHO2)
  r(272)   = k(272)*y(iTOLND)*y(iHO2)
  r(273)   = k(273)*y(iOLNN)*y(iHO2)
  r(274)   = k(274)*y(iOLND)*y(iHO2)
  r(275)   = k(275)*y(iADCN)*y(iHO2)
  r(276)   = k(276)*y(iXO2)*y(iHO2)
  r(277)   = k(277)*y(iMO2)*y(iMO2)
  r(278)   = k(278)*y(iETHP)*y(iMO2)
  r(279)   = k(279)*y(iHC3P)*y(iMO2)
  r(280)   = k(280)*y(iHC5P)*y(iMO2)
  r(281)   = k(281)*y(iHC8P)*y(iMO2)
  r(282)   = k(282)*y(iETEP)*y(iMO2)
  r(283)   = k(283)*y(iOLTP)*y(iMO2)
  r(284)   = k(284)*y(iOLIP)*y(iMO2)
  r(285)   = k(285)*y(iBENP)*y(iMO2)
  r(286)   = k(286)*y(iTLP1)*y(iMO2)
  r(287)   = k(287)*y(iTOLP)*y(iMO2)
  r(288)   = k(288)*y(iPER1)*y(iMO2)
  r(289)   = k(289)*y(iXYL1)*y(iMO2)
  r(290)   = k(290)*y(iXYLP)*y(iMO2)
  r(291)   = k(291)*y(iPER2)*y(iMO2)
  r(292)   = k(292)*y(iXYOP)*y(iMO2)
  r(293)   = k(293)*y(iISOP)*y(iMO2)
  r(294)   = k(294)*y(iAPIP)*y(iMO2)
  r(295)   = k(295)*y(iLIMP)*y(iMO2)
  r(296)   = k(296)*y(iACO3)*y(iMO2)
  r(297)   = k(297)*y(iRCO3)*y(iMO2)
  r(298)   = k(298)*y(iACTP)*y(iMO2)
  r(299)   = k(299)*y(iMEKP)*y(iMO2)
  r(300)   = k(300)*y(iKETP)*y(iMO2)
  r(301)   = k(301)*y(iMACP)*y(iMO2)
  r(302)   = k(302)*y(iMCP)*y(iMO2)
  r(303)   = k(303)*y(iMVKP)*y(iMO2)
  r(304)   = k(304)*y(iUALP)*y(iMO2)
  r(305)   = k(305)*y(iBALP)*y(iMO2)
  r(306)   = k(306)*y(iBAL1)*y(iMO2)
  r(307)   = k(307)*y(iADDC)*y(iMO2)
  r(308)   = k(308)*y(iMCTP)*y(iMO2)
  r(309)   = k(309)*y(iORAP)*y(iMO2)
  r(310)   = k(310)*y(iTOLNN)*y(iMO2)
  r(311)   = k(311)*y(iTOLND)*y(iMO2)
  r(312)   = k(312)*y(iOLNN)*y(iMO2)
  r(313)   = k(313)*y(iOLND)*y(iMO2)
  r(314)   = k(314)*y(iADCN)*y(iMO2)
  r(315)   = k(315)*y(iXO2)*y(iMO2)
  r(316)   = k(316)*y(iETHP)*y(iACO3)
  r(317)   = k(317)*y(iHC3P)*y(iACO3)
  r(318)   = k(318)*y(iHC5P)*y(iACO3)
  r(319)   = k(319)*y(iHC8P)*y(iACO3)
  r(320)   = k(320)*y(iETEP)*y(iACO3)
  r(321)   = k(321)*y(iOLTP)*y(iACO3)
  r(322)   = k(322)*y(iOLIP)*y(iACO3)
  r(323)   = k(323)*y(iBENP)*y(iACO3)
  r(324)   = k(324)*y(iTLP1)*y(iACO3)
  r(325)   = k(325)*y(iTOLP)*y(iACO3)
  r(326)   = k(326)*y(iPER1)*y(iACO3)
  r(327)   = k(327)*y(iXYL1)*y(iACO3)
  r(328)   = k(328)*y(iXYLP)*y(iACO3)
  r(329)   = k(329)*y(iPER2)*y(iACO3)
  r(330)   = k(330)*y(iXYOP)*y(iACO3)
  r(331)   = k(331)*y(iISOP)*y(iACO3)
  r(332)   = k(332)*y(iAPIP)*y(iACO3)
  r(333)   = k(333)*y(iLIMP)*y(iACO3)
  r(334)   = k(334)*y(iACO3)*y(iACO3)
  r(335)   = k(335)*y(iRCO3)*y(iACO3)
  r(336)   = k(336)*y(iACTP)*y(iACO3)
  r(337)   = k(337)*y(iMEKP)*y(iACO3)
  r(338)   = k(338)*y(iKETP)*y(iACO3)
  r(339)   = k(339)*y(iMACP)*y(iACO3)
  r(340)   = k(340)*y(iMCP)*y(iACO3)
  r(341)   = k(341)*y(iMVKP)*y(iACO3)
  r(342)   = k(342)*y(iUALP)*y(iACO3)
  r(343)   = k(343)*y(iBALP)*y(iACO3)
  r(344)   = k(344)*y(iBAL1)*y(iACO3)
  r(345)   = k(345)*y(iADDC)*y(iACO3)
  r(346)   = k(346)*y(iMCTP)*y(iACO3)
  r(347)   = k(347)*y(iORAP)*y(iACO3)
  r(348)   = k(348)*y(iTOLNN)*y(iACO3)
  r(349)   = k(349)*y(iOLNN)*y(iACO3)
  r(350)   = k(350)*y(iOLND)*y(iACO3)
  r(351)   = k(351)*y(iTOLND)*y(iACO3)
  r(352)   = k(352)*y(iADCN)*y(iACO3)
  r(353)   = k(353)*y(iXO2)*y(iACO3)
  r(354)   = k(354)*y(iRCO3)*y(iRCO3)
  r(355)   = k(355)*y(iMO2)*y(iNO3)
  r(356)   = k(356)*y(iETHP)*y(iNO3)
  r(357)   = k(357)*y(iHC3P)*y(iNO3)
  r(358)   = k(358)*y(iHC5P)*y(iNO3)
  r(359)   = k(359)*y(iHC8P)*y(iNO3)
  r(360)   = k(360)*y(iETEP)*y(iNO3)
  r(361)   = k(361)*y(iOLTP)*y(iNO3)
  r(362)   = k(362)*y(iOLIP)*y(iNO3)
  r(363)   = k(363)*y(iBENP)*y(iNO3)
  r(364)   = k(364)*y(iTLP1)*y(iNO3)
  r(365)   = k(365)*y(iTOLP)*y(iNO3)
  r(366)   = k(366)*y(iPER1)*y(iNO3)
  r(367)   = k(367)*y(iXYL1)*y(iNO3)
  r(368)   = k(368)*y(iXYLP)*y(iNO3)
  r(369)   = k(369)*y(iPER2)*y(iNO3)
  r(370)   = k(370)*y(iXYOP)*y(iNO3)
  r(371)   = k(371)*y(iISOP)*y(iNO3)
  r(372)   = k(372)*y(iAPIP)*y(iNO3)
  r(373)   = k(373)*y(iLIMP)*y(iNO3)
  r(374)   = k(374)*y(iACO3)*y(iNO3)
  r(375)   = k(375)*y(iRCO3)*y(iNO3)
  r(376)   = k(376)*y(iACTP)*y(iNO3)
  r(377)   = k(377)*y(iMEKP)*y(iNO3)
  r(378)   = k(378)*y(iKETP)*y(iNO3)
  r(379)   = k(379)*y(iMACP)*y(iNO3)
  r(380)   = k(380)*y(iMCP)*y(iNO3)
  r(381)   = k(381)*y(iMVKP)*y(iNO3)
  r(382)   = k(382)*y(iUALP)*y(iNO3)
  r(383)   = k(383)*y(iBALP)*y(iNO3)
  r(384)   = k(384)*y(iBAL1)*y(iNO3)
  r(385)   = k(385)*y(iADDC)*y(iNO3)
  r(386)   = k(386)*y(iMCTP)*y(iNO3)
  r(387)   = k(387)*y(iORAP)*y(iNO3)
  r(388)   = k(388)*y(iTOLNN)*y(iNO3)
  r(389)   = k(389)*y(iOLNN)*y(iNO3)
  r(390)   = k(390)*y(iOLND)*y(iNO3)
  r(391)   = k(391)*y(iTOLND)*y(iNO3)
  r(392)   = k(392)*y(iADCN)*y(iNO3)
  r(393)   = k(393)*y(iTOLNN)*y(iTOLNN)
  r(394)   = k(394)*y(iOLNN)*y(iOLNN)
  r(395)   = k(395)*y(iTOLNN)*y(iOLND)
  r(396)   = k(396)*y(iOLNN)*y(iOLND)
  r(397)   = k(397)*y(iTOLNN)*y(iOLNN)
  r(398)   = k(398)*y(iTOLND)*y(iTOLND)
  r(399)   = k(399)*y(iOLND)*y(iOLND)
  r(400)   = k(400)*y(iTOLND)*y(iOLND)
  r(401)   = k(401)*y(iTOLND)*y(iOLNN)
  r(402)   = k(402)*y(iTOLNN)*y(iTOLND)
  r(403)   = k(403)*y(iXO2)*y(iNO3)
  r(404)   = k(404)*y(iXO2)*y(iRCO3)
  r(405)   = k(405)*y(iXO2)*y(iXO2)
  r(406)   = k(406)*y(iTONIT)*y(iHO)
  r(407)   = k(407)*y(iUTONIT)*y(iHO)
  r(408)   = k(408)*y(iUTONIT)*y(iO3)
  r(409)   = k(409)*y(iHO)*y(iHONIT)
  r(410)   = k(410)*y(iAONIT)*y(iHO)
  r(411)   = k(411)*y(iDONIT)*y(iHO)
  r(412)   = k(412)*y(iMONIT)*y(iHO)
  r(413)   = k(413)*y(iISOP)
  r(414)   = k(414)*y(iISOPND)*y(iHO)
  r(415)   = k(415)*y(iISOPND)*y(iO3)
  r(416)   = k(416)*y(iISOPNDO2)*y(iNO)
  r(417)   = k(417)*y(iISOPNDO2)*y(iHO2)
  r(418)   = k(418)*y(iISOPNDO2)*y(iMO2)
  r(419)   = k(419)*y(iISOPNDO2)*y(iACO3)
  r(420)   = k(420)*y(iISOPNDO2)*y(iNO3)
  r(421)   = k(421)*y(iISOPNB)*y(iHO)
  r(422)   = k(422)*y(iISOPNB)*y(iO3)
  r(423)   = k(423)*y(iISOPNBO2)*y(iNO)
  r(424)   = k(424)*y(iISOPNBO2)*y(iHO2)
  r(425)   = k(425)*y(iISOPNBO2)*y(iMO2)
  r(426)   = k(426)*y(iISOPNBO2)*y(iACO3)
  r(427)   = k(427)*y(iISOPNBO2)*y(iNO3)
  r(428)   = k(428)*y(iHPALD)*y(iHO)
  r(429)   = k(429)*y(iIEPOX)*y(iHO)
  r(430)   = k(430)*y(iIEPOXOO)*y(iNO)
  r(431)   = k(431)*y(iIEPOXOO)*y(iHO2)
  r(432)   = k(432)*y(iIEPOXOO)*y(iNO3)
  r(433)   = k(433)*y(iPROPNN)*y(iHO)
  r(434)   = k(434)*y(iETHLN)*y(iHO)
  r(435)   = k(435)*y(iIMONIT)*y(iHO)
  r(436)   = k(436)*y(iISNP)*y(iHO)
  r(437)   = k(437)*y(iUHC)*y(iHO)
  r(438)   = k(438)*y(iUHC)*y(iO3)
  r(439)   = k(439)*y(iUHC)*y(iNO3)
  r(440)   = k(440)*y(iUHCP)*y(iNO)
  r(441)   = k(441)*y(iUHCP)*y(iHO2)
  r(442)   = k(442)*y(iUHCP)*y(iMO2)
  r(443)   = k(443)*y(iUHCP)*y(iACO3)
  r(444)   = k(444)*y(iUHCP)*y(iNO3)
  r(445)   = k(445)*y(iUHCAP)*y(iNO)
  r(446)   = k(446)*y(iUHCAP)*y(iHO2)
  r(447)   = k(447)*y(iUHCAP)*y(iMO2)
  r(448)   = k(448)*y(iUHCAP)*y(iACO3)
  r(449)   = k(449)*y(iUHCAP)*y(iNO3)
  r(450)   = k(450)*y(iUHCAP)*y(iNO2)
  r(451)   = k(451)*y(iIAP)*y(iHO)
  r(452)   = k(452)*y(iDIBOO)*y(iNO)
  r(453)   = k(453)*y(iDIBOO)*y(iHO2)
  r(454)   = k(454)*y(iDIBOO)*y(iMO2)
  r(455)   = k(455)*y(iDIBOO)*y(iACO3)
  r(456)   = k(456)*y(iDIBOO)*y(iNO3)
  r(457)   = k(457)*y(iMOBA)*y(iHO)
  r(458)   = k(458)*y(iMOBA)*y(iO3)
  r(459)   = k(459)*y(iMOBAOO)*y(iNO)
  r(460)   = k(460)*y(iMOBAOO)*y(iHO2)
  r(461)   = k(461)*y(iMOBAOO)*y(iMO2)
  r(462)   = k(462)*y(iMOBAOO)*y(iACO3)
  r(463)   = k(463)*y(iMOBAOO)*y(iNO3)
  r(464)   = k(464)*y(iHAC)*y(iHO)
  r(465)   = k(465)*y(iGLYC)*y(iHO)
  r(466)   = k(466)*y(iGLYC)*y(iNO3)
  r(467)   = k(467)*y(iDHMOB)*y(iHO)
  r(468)   = k(468)*y(iPYAC)*y(iHO)
  r(469)   = k(469)*y(iMACRO2)
  r(470)   = k(470)*y(iMACRO2)*y(iNO)
  r(471)   = k(471)*y(iMACRO2)*y(iHO2)
  r(472)   = k(472)*y(iMACRO2)*y(iMO2)
  r(473)   = k(473)*y(iMACRO2)*y(iACO3)
  r(474)   = k(474)*y(iMACRO2)*y(iNO3)
  r(475)   = k(475)*y(iVRP)*y(iHO)
  r(476)   = k(476)*y(iMACRN)*y(iHO)
  r(477)   = k(477)*y(iMVKN)*y(iHO)

  return
end subroutine rxnrates

!**********************************************************************************************************************!
! GasRateCoeffs - calculates gas-phase reaction rate coefficients
!                 at ts
!**********************************************************************************************************************!
subroutine GasRateCoeffs(ts, k)
  real(kind=dp) :: ts
  real(kind=dp), dimension(nrxn) :: k

  ! get photolysis rate coefficients
  call GasPhotoRateCoeffs(ts, k)

  ! get thermal rate coefficients
  call GasThermalRateCoeffs(ts, k)

  return
end subroutine GasRateCoeffs

!**********************************************************************************************************************!
! GasPhotoRateCoeffs - handles calculation of photolysis rate
!                      coefficients at ts
!**********************************************************************************************************************!
subroutine GasPhotoRateCoeffs(ts, k)
  real(kind=dp), dimension(nrxn) :: k
  real(kind=dp) :: ts, cz, za, pi, time21, zalt_m
  real(kind=dp), parameter :: mincz=0.017452406   ! cos(89deg)

  ! set current z value
  zalt_m=zcurrent

  ! calculate current zenith angle
  if (OPT_SIMTYPE .eq. SSTATE) then
    ! for steady-state, solar time doesn't change
    ! convert tstart to days
    time21 = tstart/(24.*3600.)
  else
    ! for dynamic, use current simulation time
    ! convert ts to days
    time21 = ts/(24.*3600.)
  end if
  za = SolarZenithAngle(time21)
  pi=2.0*acos(0.0)
  cz = dcos(za*pi/180.) 
  if (cz < mincz) then
   ! nighttime, so don't bother calculating anything

  ! Nighttime values set to zero
  ! Generated by chmgen for mechanism racm2_plus
  k(1)     = 0.0
  k(2)     = 0.0
  k(3)     = 0.0
  k(4)     = 0.0
  k(5)     = 0.0
  k(6)     = 0.0
  k(7)     = 0.0
  k(8)     = 0.0
  k(9)     = 0.0
  k(10)    = 0.0
  k(11)    = 0.0
  k(12)    = 0.0
  k(13)    = 0.0
  k(14)    = 0.0
  k(15)    = 0.0
  k(16)    = 0.0
  k(17)    = 0.0
  k(18)    = 0.0
  k(19)    = 0.0
  k(20)    = 0.0
  k(21)    = 0.0
  k(22)    = 0.0
  k(23)    = 0.0
  k(24)    = 0.0
  k(25)    = 0.0
  k(26)    = 0.0
  k(27)    = 0.0
  k(28)    = 0.0
  k(29)    = 0.0
  k(30)    = 0.0
  k(31)    = 0.0
  k(32)    = 0.0
  k(33)    = 0.0
  k(34)    = 0.0
  k(35)    = 0.0
  k(36)    = 0.0
  k(37)    = 0.0
  k(38)    = 0.0
  k(39)    = 0.0
  k(40)    = 0.0
  k(41)    = 0.0
  k(42)    = 0.0
  k(43)    = 0.0
  k(44)    = 0.0
  k(45)    = 0.0
  k(46)    = 0.0
  k(47)    = 0.0
  k(48)    = 0.0
  k(49)    = 0.0
  k(50)    = 0.0
  k(51)    = 0.0
  k(52)    = 0.0
  k(53)    = 0.0
  k(54)    = 0.0
  k(55)    = 0.0
  k(56)    = 0.0
  k(57)    = 0.0
  k(58)    = 0.0

  else
    ! daytime, calculate the Js
    call CalcJPhoto(cz, zalt_m)

  ! Daytime values mapped to output from CalcJPhoto
  ! Generated by chmgen for mechanism racm2_plus
  k(1)     = kphoto(jo3b)
  k(2)     = kphoto(jo3a)
  k(3)     = kphoto(jh2o2)
  k(4)     = kphoto(jno2)
  k(5)     = kphoto(jno3a)
  k(6)     = kphoto(jno3b)
  k(7)     = kphoto(jhono)
  k(8)     = kphoto(jhno3)
  k(9)     = kphoto(jho2no2)
  k(10)    = kphoto(jhchoa)
  k(11)    = kphoto(jhchob)
  k(12)    = kphoto(jch3cho)
  k(13)    = kphoto(jc3h7choa)
  k(14)    = kphoto(jacet)
  k(15)    = kphoto(jacetol)
  k(16)    = kphoto(jmek)
  k(17)    = kphoto(jacet)
  k(18)    = kphoto(jacetol)
  k(19)    = kphoto(jmacra)+kphoto(jmacrb)
  k(20)    = kphoto(jmvka)+kphoto(jmvkb)
  k(21)    = kphoto(jglyoxa)
  k(22)    = kphoto(jglyoxb)
  k(23)    = kphoto(jglyoxc)
  k(24)    = kphoto(jmglyox)
  k(25)    = kphoto(jmglyox)
  k(26)    = kphoto(jmglyox)
  k(27)    = kphoto(jbald)
  k(28)    = kphoto(jch3ooh)
  k(29)    = kphoto(jch3ooh)
  k(30)    = kphoto(jpaa)
  k(31)    = kphoto(jch3no3)
  k(32)    = kphoto(jpana)
  k(33)    = kphoto(jpanb)
  k(34)    = kphoto(jtc4h9no3)/3.0
  k(35)    = kphoto(jtc4h9no3)/3.0
  k(36)    = kphoto(jtc4h9no3)/3.0
  k(37)    = kphoto(jtc4h9no3)/3.0
  k(38)    = kphoto(jnc3h7no3)/3.0
  k(39)    = kphoto(jnc3h7no3)/3.0
  k(40)    = kphoto(jnc3h7no3)
  k(41)    = kphoto(jtc4h9no3)/3.0
  k(42)    = kphoto(jhpald)
  k(43)    = kphoto(jch3ooh)
  k(44)    = kphoto(jnoab)
  k(45)    = kphoto(jnoab)
  k(46)    = kphoto(jnc3h7no3)/3.0
  k(47)    = kphoto(jch3ooh)
  k(48)    = kphoto(jmacra)+kphoto(jmacrb)
  k(49)    = kphoto(jch3ooh)
  k(50)    = kphoto(jmacra)+kphoto(jmacrb)
  k(51)    = kphoto(jacet)
  k(52)    = kphoto(jhoch2cho)
  k(53)    = kphoto(jc3h7choa)
  k(54)    = kphoto(jpyra)
  k(55)    = kphoto(jch3ooh)
  k(56)    = kphoto(jch3ooh)
  k(57)    = kphoto(jic3h7cho)
  k(58)    = kphoto(jnoab)

  end if

  return
end subroutine GasPhotoRateCoeffs

!**********************************************************************************************************************!
! CalcJPhoto - calculates photolysis frequencies (1/s) for a given
!              altitude and cosine(zenith angle).
!              Photolysis frequencies were generated from TUV 5.0
!              (Madronich, S. and S. Flocke, Theoretical estimation of 
!              biologically effective UV radiation at the Earth's surface, 
!              in Solar Ultraviolet Radiation - Modeling, Measurements and 
!              Effects (Zerefos, C., ed.). NATO ASI Series Vol. I52, 
!              Springer-Verlag, Berlin, 1997.) as a function of altitude 
!              above sea level and zenith angle.  For each photolysis reaction 
!              polynomial fits were created as a function of cosine(zenith 
!              angle) at seven altitudes.  At a given altitude, the 
!              photolysis frequency for each reaction is determined 
!              by interpolation between bounding altitudes. Frequencies are
!              valid from 0 to 12 km above mean sea level.
!**********************************************************************************************************************!
subroutine CalcJPhoto(cz, zalt_m)
  integer(kind=i4) :: i, j, l, lm1, jp
  real(kind=dp)    :: cz, zalt_m
  real(kind=dp)    :: alpha, zf, zf1, cz2, cz3, cz4, cz5, cz6

  ! calculate powers of cz
  cz2=cz*cz
  cz3=cz2*cz
  cz4=cz3*cz
  cz5=cz4*cz
  cz6=cz5*cz

  ! determine levels for interpolation
  if (zalt_m .ge. 12000.) then    ! just use values at 12km
    alpha = 1.0
    l = 7
    lm1 = 7
  else if (zalt_m .lt. 12000. .and. zalt_m .ge. 10000.) then
    alpha = (12000. - zalt_m)/2000.
    l = 7
    lm1 = 6
  else if (zalt_m .lt. 10000. .and. zalt_m .ge. 8000.) then
    alpha = (10000. - zalt_m)/2000.
    l = 6
    lm1 = 5
  else if (zalt_m .lt. 8000. .and. zalt_m .ge. 6000.) then
    alpha = (8000. - zalt_m)/2000.
    l = 5
    lm1 = 4
  else if (zalt_m .lt. 6000. .and. zalt_m .ge. 4000.) then
    alpha = (6000. - zalt_m)/2000.
    l = 4
    lm1 = 3
  else if (zalt_m .lt. 4000. .and. zalt_m .ge. 2000.) then
    alpha = (4000. - zalt_m)/2000.
    l = 3
    lm1 = 2
  else if (zalt_m .lt. 2000.) then
    alpha = (2000. - zalt_m)/2000.
    l = 2
    lm1 = 1
  end if

  ! calculate interpolation parameters
  zf  = alpha
  zf1 = 1.0 - alpha

  ! calculate photolysis frequencies
  kphoto(jo3a) = fjo3a(cz, cz2, cz3, cz4, l, lm1, zf, zf1)
  kphoto(jo3b) = fjo3b(cz, cz2, cz3, cz4, cz5, cz6, l, lm1, zf, zf1)
  kphoto(jh2o2) = fjh2o2(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jno2) = fjno2(cz, cz2, cz3, cz4, cz5, cz6, l, lm1, zf, zf1)
  kphoto(jno3a) = fjno3a(cz, cz2, cz3, cz4, cz5, cz6, l, lm1, zf, zf1)
  kphoto(jno3b) = fjno3b(cz, cz2, cz3, cz4, cz5, cz6, l, lm1, zf, zf1)
  kphoto(jhono) = fjhono(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jhno3) = fjhno3(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jho2no2) = fjho2no2(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jhchoa) = fjhchoa(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jhchob) = fjhchob(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jch3cho) = fjch3cho(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jc2h5cho) = fjc2h5cho(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jc3h7choa) = fjc3h7choa(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jc3h7chob) = fjc3h7chob(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jic3h7cho) = fjic3h7cho(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jmacra) = fjmacra(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jmacrb) = fjmacrb(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jacet) = fjacet(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jmek) = fjmek(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jmvka) = fjmvka(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jmvkb) = fjmvkb(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jglyoxa) = fjglyoxa(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jglyoxb) = fjglyoxb(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jglyoxc) = fjglyoxc(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jmglyox) = fjmglyox(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jbiacet) = fjbiacet(cz, cz2, cz3, cz4, cz5, cz6, l, lm1, zf, zf1)
  kphoto(jch3ooh) = fjch3ooh(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jch3no3) = fjch3no3(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jc2h5no3) = fjc2h5no3(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jnc3h7no3) = fjnc3h7no3(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jic3h7no3) = fjic3h7no3(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jtc4h9no3) = fjtc4h9no3(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jnoaa) = fjnoaa(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jnoab) = fjnoab(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jhoch2cho) = fjhoch2cho(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jacetol) = fjacetol(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jpaa) = fjpaa(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jpyra) = fjpyra(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jhpald) = fjhpald(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jacro) = fjacro(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jhmhp) = fjhmhp(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jneth) = fjneth(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jnacet) = fjnacet(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jpana) = fjpana(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jpanb) = fjpanb(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jppna) = fjppna(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jppnb) = fjppnb(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jn2o5a) = fjn2o5a(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jn2o5b) = fjn2o5b(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  kphoto(jbald) = fjbald(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)

  ! apply fj factor to account for reduction of actinic flux
  ! within the canopy
  do jp=1,nphoto
    kphoto(jp)=kphoto(jp)*fj(zpt)
  end do

end subroutine CalcJPhoto              

!**********************************************************************************************************************!
! fjo3a - function to calculate photolysis frequency (1/s) for the reaction
!
!         O3 + hv --> O(1D) + O2
!         ozone
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjo3a(cz, cz2, cz3, cz4, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjo3a
  
  data a0/+4.651D-08,+8.749D-08,+1.055D-07,+1.133D-07,+1.151D-07,+1.183D-07,+1.272D-07/
  data a1/+1.471D-06,-5.579D-07,-1.934D-06,-2.890D-06,-3.460D-06,-3.884D-06,-4.293D-06/
  data a2/-1.785D-06,+1.137D-05,+2.178D-05,+3.069D-05,+3.851D-05,+4.690D-05,+5.839D-05/
  data a3/+7.576D-05,+6.905D-05,+5.626D-05,+4.228D-05,+2.885D-05,+1.512D-05,-2.091D-07/
  data a4/-3.260D-05,-3.490D-05,-3.152D-05,-2.661D-05,-2.164D-05,-1.637D-05,-1.054D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1) + a1(lm1)*cz + a2(lm1)*cz2 + a3(lm1)*cz3 + a4(lm1)*cz4
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjo3a = zf1*jphi + zf*jplo 

end function fjo3a

!**********************************************************************************************************************!
! fjo3b - function to calculate photolysis frequency (1/s) for the reaction
!
!         O3 + hv --> O(3P) + O2
!         ozone
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjo3b(cz, cz2, cz3, cz4, cz5, cz6, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5, cz6
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5, a6
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjo3b
  
  data a0/+4.516D-06,+7.547D-06,+1.859D-05,+2.901D-05,+3.846D-05,+4.970D-05,+6.275D-05/
  data a1/+0.0002296,+0.0011360,+0.0015160,+0.0017150,+0.0018930,+0.0020350,+0.0021490/
  data a2/+0.0048210,-0.0004056,-0.0031760,-0.0047490,-0.0062100,-0.0074570,-0.0085580/
  data a3/-0.0181000,-0.0048620,+0.0032900,+0.0080470,+0.0125900,+0.0164900,+0.0200600/
  data a4/+0.0290600,+0.0114500,-0.0006084,-0.0077740,-0.0147600,-0.0207100,-0.0262900/
  data a5/-0.0220600,-0.0101800,-0.0013790,+0.0039210,+0.0091710,+0.0136000,+0.0178300/
  data a6/+0.0064610,+0.0032550,+0.0007384,-0.0007947,-0.0023330,-0.0036150,-0.0048620/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5 + a6(l)*cz6
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5+a6(lm1)*cz6
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjo3b = zf1*jphi + zf*jplo 

end function fjo3b

!**********************************************************************************************************************!
! fjh2o2 -function to calculate photolysis frequency (1/s) for the reaction
!
!         H2O2 + hv --> 2OH
!         hydrogen peroxide
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjh2o2(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjh2o2
  
  data a0/+5.089D-08,+6.023D-08,+5.978D-08,+5.443D-08,+4.627D-08,+3.871D-08,+3.673D-08/
  data a1/+1.201D-06,+5.192D-07,+2.428D-07,+4.996D-07,+1.497D-06,+3.430D-06,+6.449D-06/
  data a2/+1.137D-05,+2.353D-05,+3.276D-05,+3.898D-05,+4.103D-05,+3.737D-05,+2.728D-05/
  data a3/-8.381D-07,-2.751D-05,-5.306D-05,-7.435D-05,-8.808D-05,-8.974D-05,-7.671D-05/
  data a4/-8.771D-06,+1.309D-05,+3.825D-05,+6.138D-05,+7.863D-05,+8.497D-05,+7.717D-05/
  data a5/+4.551D-06,-1.956D-06,-1.065D-05,-1.915D-05,-2.595D-05,-2.914D-05,-2.739D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjh2o2 = zf1*jphi + zf*jplo 

end function fjh2o2

!**********************************************************************************************************************!
! fjno2 - function to calculate photolysis frequency (1/s) for the reaction
!
!         NO2 + hv --> NO + O(3P)
!         nitrogen dioxide
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjno2(cz, cz2, cz3, cz4, cz5, cz6, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5, cz6
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5, a6
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjno2
  
  data a0/+0.0001472,+0.0001613,+0.0001628,+0.0001622,+0.0001649,+0.0001825,+0.0002437/
  data a1/+0.0028890,+0.0013940,+0.0023140,+0.0054820,+0.0113900,+0.0204400,+0.0321600/
  data a2/+0.0341300,+0.0841500,+0.1090000,+0.1127000,+0.0920100,+0.0416500,-0.0359800/
  data a3/-0.0451700,-0.2353000,-0.3583000,-0.4164000,-0.3967000,-0.2779000,-0.0626700/
  data a4/+0.0050470,+0.3056000,+0.5269000,+0.6547000,+0.6644000,+0.5174000,+0.2125000/
  data a5/+0.0254200,-0.1974000,-0.3759000,-0.4889000,-0.5149000,-0.4221000,-0.2063000/
  data a6/-0.0127800,+0.0509600,+0.1052000,+0.1414000,+0.1527000,+0.1291000,+0.0686500/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5 + a6(l)*cz6
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5+a6(lm1)*cz6
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjno2 = zf1*jphi + zf*jplo 

end function fjno2

!**********************************************************************************************************************!
! fjno3a - function to calculate photolysis frequency (1/s) for the reaction
!
!         NO3 + hv --> NO + O2
!         nitrate radical
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjno3a(cz, cz2, cz3, cz4, cz5, cz6, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5, cz6
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5, a6
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjno3a
  
  data a0/+0.0002113,+0.0003791,+0.0010420,+0.0016620,+0.0021950,+0.0027890,+0.0034410/
  data a1/+0.0127900,+0.0685600,+0.0898500,+0.0999900,+0.1084000,+0.1154000,+0.1216000/
  data a2/+0.2924000,-0.0422400,-0.2031000,-0.2895000,-0.3624000,-0.4298000,-0.4928000/
  data a3/-1.1290000,-0.2637000,+0.2125000,+0.4797000,+0.7074000,+0.9254000,+1.1330000/
  data a4/+1.8310000,+0.6624000,-0.0407600,-0.4453000,-0.7923000,-1.1310000,-1.4550000/
  data a5/-1.3960000,-0.5982000,-0.0862600,+0.2130000,+0.4710000,+0.7260000,+0.9697000/
  data a6/+0.4097000,+0.1925000,+0.0462600,-0.0401200,-0.1150000,-0.1896000,-0.2607000/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5 + a6(l)*cz6
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5+a6(lm1)*cz6
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjno3a = zf1*jphi + zf*jplo 

end function fjno3a

!**********************************************************************************************************************!
! fjno3b - function to calculate photolysis frequency (1/s) for the reaction
!
!         NO3 + hv --> NO2 + O(3P)
!         nitrate radical
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjno3b(cz, cz2, cz3, cz4, cz5, cz6, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5, cz6
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5, a6
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjno3b
  
  data a0/+0.0020070,+0.0026260,+0.0057260,+0.0092890,+0.0129700,+0.0176800,+0.0235300/
  data a1/+0.0571400,+0.4115000,+0.6146000,+0.7388000,+0.8471000,+0.9384000,+1.0090000/
  data a2/+2.3310000,+0.5458000,-0.8554000,-1.7840000,-2.6550000,-3.4460000,-4.1340000/
  data a3/-8.4190000,-4.5620000,-0.5793000,+2.1500000,+4.8380000,+7.3330000,+9.5830000/
  data a4/+13.180000,+8.7900000,+3.0430000,-0.9543000,-5.0410000,-8.8670000,-12.390000/
  data a5/-9.8160000,-7.2660000,-3.1420000,-0.2579000,+2.7830000,+5.6390000,+8.3050000/
  data a6/+2.8340000,+2.2370000,+1.0700000,+0.2534000,-0.6305000,-1.4610000,-2.2440000/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5 + a6(l)*cz6
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5+a6(lm1)*cz6
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjno3b = zf1*jphi + zf*jplo 

end function fjno3b

!**********************************************************************************************************************!
! fjhono -function to calculate photolysis frequency (1/s) for the reaction
!
!         HONO + hv --> NO + OH
!         nitrous acid
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjhono(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjhono
  
  data a0/+2.977D-05,+3.129D-05,+2.922D-05,+2.659D-05,+2.507D-05,+2.717D-05,+3.790D-05/
  data a1/+0.0005187,+0.0005138,+0.0009115,+0.0016810,+0.0028910,+0.0046170,+0.0067360/
  data a2/+0.0068190,+0.0120700,+0.0138000,+0.0128200,+0.0088960,+0.0012700,-0.0095280/
  data a3/-0.0103500,-0.0258100,-0.0337600,-0.0357100,-0.0311000,-0.0177400,+0.0034860/
  data a4/+0.0064020,+0.0222400,+0.0317300,+0.0357200,+0.0335400,+0.0227000,+0.0038820/
  data a5/-0.0014490,-0.0070690,-0.0107400,-0.0125800,-0.0123200,-0.0089600,-0.0027230/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjhono = zf1*jphi + zf*jplo 

end function fjhono

!**********************************************************************************************************************!
! fjhno3 -function to calculate photolysis frequency (1/s) for the reaction
!
!         HNO3 + hv --> NO2 + OH
!         nitric acid
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjhno3(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjhno3
  
  data a0/+1.754D-09,+2.216D-09,+2.304D-09,+2.186D-09,+1.905D-09,+1.555D-09,+1.284D-09/
  data a1/+6.207D-08,+2.199D-08,-1.322D-08,-3.606D-08,-3.789D-08,-1.576D-08,+3.566D-08/
  data a2/+3.135D-07,+7.865D-07,+1.251D-06,+1.669D-06,+1.975D-06,+2.141D-06,+2.219D-06/
  data a3/+1.480D-06,+8.807D-07,-1.622D-07,-1.315D-06,-2.336D-06,-3.109D-06,-3.621D-06/
  data a4/-1.713D-06,-1.578D-06,-7.441D-07,+3.377D-07,+1.377D-06,+2.243D-06,+2.843D-06/
  data a5/+5.908D-07,+6.380D-07,+3.952D-07,+3.581D-08,-3.276D-07,-6.481D-07,-8.732D-07/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjhno3 = zf1*jphi + zf*jplo 

end function fjhno3

!**********************************************************************************************************************!
! fjho2no2 -function to calculate photolysis frequency (1/s) for the reaction
!
!         HO2NO2 + hv --> NO2 + HO2
!         peroxynitric acid
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjho2no2(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjho2no2
  
  data a0/+1.077D-08,+1.596D-08,+1.883D-08,+1.953D-08,+1.828D-08,+1.518D-08,+1.130D-08/
  data a1/+3.754D-07,+5.299D-08,-3.052D-07,-5.758D-07,-6.780D-07,-4.707D-07,+1.485D-07/
  data a2/+2.651D-06,+7.015D-06,+1.231D-05,+1.782D-05,+2.316D-05,+2.730D-05,+2.950D-05/
  data a3/+1.070D-05,+5.948D-06,-4.574D-06,-1.772D-05,-3.227D-05,-4.550D-05,-5.497D-05/
  data a4/-1.318D-05,-1.270D-05,-4.641D-06,+7.175D-06,+2.146D-05,+3.534D-05,+4.611D-05/
  data a5/+4.683D-06,+5.393D-06,+3.123D-06,-7.115D-07,-5.656D-06,-1.066D-05,-1.470D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjho2no2 = zf1*jphi + zf*jplo 

end function fjho2no2

!**********************************************************************************************************************!
! fjhchoa -function to calculate photolysis frequency (1/s) for the reaction
!
!         HCHO + hv --> HCO + H
!         formaldehyde
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjhchoa(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjhchoa
  
  data a0/+1.412D-07,+1.931D-07,+2.137D-07,+2.093D-07,+1.841D-07,+1.449D-07,+1.084D-07/
  data a1/+3.562D-06,+4.664D-07,-2.063D-06,-2.984D-06,-1.134D-06,+4.994D-06,+1.618D-05/
  data a2/+4.027D-05,+9.071D-05,+0.0001419,+0.0001895,+0.0002266,+0.0002427,+0.0002268/
  data a3/+2.702D-05,-6.359D-05,-0.0001846,-0.0003149,-0.0004364,-0.0005222,-0.0005401/
  data a4/-6.610D-05,-6.181D-06,+0.0001025,+0.0002315,+0.0003619,+0.0004661,+0.0005084/
  data a5/+2.836D-05,+1.440D-05,-2.070D-05,-6.559D-05,-0.0001132,-0.0001537,-0.0001736/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjhchoa = zf1*jphi + zf*jplo 

end function fjhchoa

!**********************************************************************************************************************!
! fjhchob -function to calculate photolysis frequency (1/s) for the reaction
!
!         HCHO + hv --> CO + H2
!         formaldehyde
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjhchob(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjhchob
  
  data a0/+4.517D-07,+5.656D-07,+5.925D-07,+5.692D-07,+5.128D-07,+4.635D-07,+5.013D-07/
  data a1/+1.030D-05,+5.606D-06,+5.209D-06,+1.105D-05,+2.716D-05,+5.819D-05,+0.0001064/
  data a2/+0.0001000,+0.0002175,+0.0003129,+0.0003823,+0.0004014,+0.0003365,+0.0001600/
  data a3/-6.849D-05,-0.0003420,-0.0006091,-0.0008481,-0.0009996,-0.0009793,-0.0007096/
  data a4/-1.357D-05,+0.0002268,+0.0004952,+0.0007589,+0.0009558,+0.0009989,+0.0008038/
  data a5/+1.939D-05,-5.669D-05,-0.0001509,-0.0002491,-0.0003282,-0.0003565,-0.0003019/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjhchob = zf1*jphi + zf*jplo 

end function fjhchob

!**********************************************************************************************************************!
! fjch3cho -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH3CHO + hv --> CH3 + HCO
!         acetaldehyde
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjch3cho(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjch3cho
  
  data a0/+7.448D-09,+1.429D-08,+2.167D-08,+2.877D-08,+3.462D-08,+3.746D-08,+3.692D-08/
  data a1/+3.715D-07,+1.288D-07,-3.725D-07,-1.043D-06,-1.802D-06,-2.335D-06,-2.195D-06/
  data a2/+6.601D-07,+4.398D-06,+1.177D-05,+2.305D-05,+3.922D-05,+5.962D-05,+8.454D-05/
  data a3/+1.673D-05,+1.966D-05,+1.250D-05,-4.520D-06,-3.488D-05,-7.804D-05,-0.0001334/
  data a4/-1.762D-05,-2.649D-05,-2.524D-05,-1.456D-05,+9.714D-06,+4.745D-05,+9.704D-05/
  data a5/+5.770D-06,+9.924D-06,+1.063D-05,+8.171D-06,+8.189D-07,-1.141D-05,-2.766D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjch3cho = zf1*jphi + zf*jplo 

end function fjch3cho

!**********************************************************************************************************************!
! fjc2h5cho -function to calculate photolysis frequency (1/s) for the reaction
!
!         C2H5CHO + hv --> C2H5 + HCO
!         propionaldehyde
!         (propanal)
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjc2h5cho(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjc2h5cho
  
  data a0/+4.819D-08,+7.950D-08,+1.040D-07,+1.200D-07,+1.232D-07,+1.125D-07,+9.759D-08/
  data a1/+1.598D-06,+3.400D-07,-1.303D-06,-2.712D-06,-2.840D-06,-1.236D-07,+7.272D-06/
  data a2/+1.079D-05,+3.318D-05,+6.501D-05,+0.0001047,+0.0001476,+0.0001847,+0.0002079/
  data a3/+4.057D-05,+1.875D-05,-3.860D-05,-0.0001255,-0.0002329,-0.0003418,-0.0004333/
  data a4/-5.098D-05,-5.029D-05,-8.666D-06,+6.710D-05,+0.0001690,+0.0002802,+0.0003823/
  data a5/+1.808D-05,+2.210D-05,+1.083D-05,-1.342D-05,-4.804D-05,-8.758D-05,-0.0001257/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjc2h5cho = zf1*jphi + zf*jplo 

end function fjc2h5cho

!**********************************************************************************************************************!
! fjc3h7choa -function to calculate photolysis frequency (1/s) for the reaction
!
!         n-C3H7CHO + hv --> n-C3H7 + HCO
!         n-butyraldehyde
!         (n-butanal)
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjc3h7choa(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjc3h7choa
  
  data a0/+6.362D-08,+8.398D-08,+9.039D-08,+8.724D-08,+7.663D-08,+6.238D-08,+5.170D-08/
  data a1/+1.620D-06,+3.794D-07,-4.969D-07,-6.757D-07,+2.742D-07,+2.872D-06,+7.450D-06/
  data a2/+1.624D-05,+3.674D-05,+5.602D-05,+7.306D-05,+8.532D-05,+8.897D-05,+8.094D-05/
  data a3/+1.112D-05,-2.710D-05,-7.339D-05,-0.0001213,-0.0001639,-0.0001910,-0.0001932/
  data a4/-2.675D-05,-3.826D-08,+4.166D-05,+8.947D-05,+0.0001359,+0.0001704,+0.0001819/
  data a5/+1.146D-05,+4.686D-06,-8.779D-06,-2.545D-05,-4.258D-05,-5.624D-05,-6.216D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjc3h7choa = zf1*jphi + zf*jplo 

end function fjc3h7choa

!**********************************************************************************************************************!
! fjc3h7chob -function to calculate photolysis frequency (1/s) for the reaction
!
!         n-C3H7CHO + hv --> CH3CHO + CH2=CH2
!         n-butyraldehyde
!         (n-butanal)
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjc3h7chob(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjc3h7chob
  
  data a0/+3.028D-08,+3.983D-08,+4.299D-08,+4.166D-08,+3.664D-08,+2.985D-08,+2.463D-08/
  data a1/+7.698D-07,+1.974D-07,-2.312D-07,-3.335D-07,+1.157D-07,+1.353D-06,+3.546D-06/
  data a2/+7.752D-06,+1.733D-05,+2.663D-05,+3.491D-05,+4.077D-05,+4.250D-05,+3.856D-05/
  data a3/+5.230D-06,-1.240D-05,-3.480D-05,-5.812D-05,-7.847D-05,-9.136D-05,-9.206D-05/
  data a4/-1.265D-05,-6.451D-07,+1.968D-05,+4.309D-05,+6.529D-05,+8.160D-05,+8.667D-05/
  data a5/+5.415D-06,+2.501D-06,-4.119D-06,-1.233D-05,-2.052D-05,-2.696D-05,-2.960D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjc3h7chob = zf1*jphi + zf*jplo 

end function fjc3h7chob

!**********************************************************************************************************************!
! fjic3h7cho -function to calculate photolysis frequency (1/s) for the reaction
!
!         i-C3H7CHO + hv --> i-C3H7 + HCO
!         isobutyraldehyde
!         (2-methyl propanal)
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjic3h7cho(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjic3h7cho
  
  data a0/+2.541D-07,+3.452D-07,+3.809D-07,+3.751D-07,+3.298D-07,+2.602D-07,+1.958D-07/
  data a1/+6.469D-06,+7.109D-07,-4.251D-06,-6.580D-06,-4.178D-06,+5.271D-06,+2.331D-05/
  data a2/+7.232D-05,+0.0001620,+0.0002543,+0.0003406,+0.0004091,+0.0004424,+0.0004273/
  data a3/+6.852D-05,-8.565D-05,-0.0003006,-0.0005341,-0.0007541,-0.0009143,-0.0009741/
  data a4/-0.0001404,-4.573D-05,+0.0001441,+0.0003732,+0.0006073,+0.0007970,+0.0008971/
  data a5/+5.814D-05,+3.855D-05,-2.188D-05,-0.0001009,-0.0001860,-0.0002589,-0.0003022/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjic3h7cho = zf1*jphi + zf*jplo 

end function fjic3h7cho

!**********************************************************************************************************************!
! fjmacra -function to calculate photolysis frequency (1/s) for the reaction
!
!         MACR + hv --> CH2=C(CH3) + HCO
!         methacrolein
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjmacra(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjmacra
  
  data a0/+1.313D-08,+1.477D-08,+1.434D-08,+1.313D-08,+1.176D-08,+1.137D-08,+1.379D-08/
  data a1/+2.596D-07,+1.895D-07,+2.677D-07,+5.081D-07,+9.673D-07,+1.684D-06,+2.648D-06/
  data a2/+2.874D-06,+5.569D-06,+7.099D-06,+7.589D-06,+6.704D-06,+4.131D-06,-2.571D-07/
  data a3/-3.249D-06,-1.030D-05,-1.541D-05,-1.848D-05,-1.864D-05,-1.506D-05,-7.153D-06/
  data a4/+1.250D-06,+7.973D-06,+1.352D-05,+1.741D-05,+1.863D-05,+1.635D-05,+9.760D-06/
  data a5/-6.028D-08,-2.325D-06,-4.369D-06,-5.916D-06,-6.563D-06,-6.016D-06,-3.932D-06/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjmacra = zf1*jphi + zf*jplo 

end function fjmacra

!**********************************************************************************************************************!
! fjmacrb -function to calculate photolysis frequency (1/s) for the reaction
!
!         MACR + hv --> CH2=C(CH3)CO + H
!         methacrolein
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjmacrb(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjmacrb
  
  data a0/+1.313D-08,+1.477D-08,+1.434D-08,+1.313D-08,+1.176D-08,+1.137D-08,+1.379D-08/
  data a1/+2.596D-07,+1.895D-07,+2.677D-07,+5.081D-07,+9.673D-07,+1.684D-06,+2.648D-06/
  data a2/+2.874D-06,+5.569D-06,+7.099D-06,+7.589D-06,+6.704D-06,+4.131D-06,-2.571D-07/
  data a3/-3.249D-06,-1.030D-05,-1.541D-05,-1.848D-05,-1.864D-05,-1.506D-05,-7.153D-06/
  data a4/+1.250D-06,+7.973D-06,+1.352D-05,+1.741D-05,+1.863D-05,+1.635D-05,+9.760D-06/
  data a5/-6.028D-08,-2.325D-06,-4.369D-06,-5.916D-06,-6.563D-06,-6.016D-06,-3.932D-06/
  data a0/+1.313D-08,+1.477D-08,+1.434D-08,+1.313D-08,+1.176D-08,+1.137D-08,+1.379D-08/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjmacrb = zf1*jphi + zf*jplo 

end function fjmacrb
  
!**********************************************************************************************************************!
! fjacet -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH3COCH3 + hv --> CH3CO + CH3
!         acetone
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjacet(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjacet
  
  data a0/+8.831D-11,+1.412D-10,+1.994D-10,+2.483D-10,+2.882D-10,+3.339D-10,+4.428D-10/
  data a1/+3.321D-08,+3.899D-08,+3.642D-08,+3.192D-08,+2.809D-08,+2.553D-08,+2.534D-08/
  data a2/-2.003D-07,-2.946D-07,-3.008D-07,-2.779D-07,-2.549D-07,-2.425D-07,-2.346D-07/
  data a3/+1.275D-06,+1.904D-06,+2.172D-06,+2.329D-06,+2.509D-06,+2.788D-06,+3.598D-06/
  data a4/-6.661D-07,-1.383D-06,-1.728D-06,-1.943D-06,-2.180D-06,-2.501D-06,-3.479D-06/
  data a5/+9.562D-08,+3.419D-07,+4.707D-07,+5.532D-07,+6.420D-07,+7.532D-07,+1.117D-06/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjacet = zf1*jphi + zf*jplo 

end function fjacet

!**********************************************************************************************************************!
! fjmek  -function to calculate photolysis frequency (1/s) for the reaction
!
!         MEK + hv --> CH3CO + CH2CH3
!         methyl ethyl ketone
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjmek(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjmek
  
  data a0/+1.789D-08,+2.900D-08,+3.756D-08,+4.337D-08,+4.513D-08,+4.159D-08,+3.669D-08/
  data a1/+5.801D-07,+1.167D-07,-4.939D-07,-1.083D-06,-1.343D-06,-7.477D-07,+1.058D-06/
  data a2/+4.065D-06,+1.205D-05,+2.324D-05,+3.739D-05,+5.324D-05,+6.748D-05,+7.910D-05/
  data a3/+1.533D-05,+8.566D-06,-9.999D-06,-3.910D-05,-7.630D-05,-0.0001141,-0.0001497/
  data a4/-1.955D-05,-2.049D-05,-7.915D-06,+1.674D-05,+5.123D-05,+8.825D-05,+0.0001255/
  data a5/+7.013D-06,+8.869D-06,+5.722D-06,-2.037D-06,-1.363D-05,-2.649D-05,-3.997D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjmek = zf1*jphi + zf*jplo 

end function fjmek

!**********************************************************************************************************************!
! fjmvka  -function to calculate photolysis frequency (1/s) for the reaction
!
!         MVK + hv --> CH3CH=CH2 + CO
!         methyl vinyl ketone
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjmvka(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjmvka
  
  data a0/+1.826D-08,+2.205D-08,+2.255D-08,+2.108D-08,+1.850D-08,+1.610D-08,+1.628D-08/
  data a1/+4.065D-07,+2.043D-07,+1.444D-07,+3.082D-07,+7.905D-07,+1.693D-06,+3.043D-06/
  data a2/+4.191D-06,+8.727D-06,+1.237D-05,+1.483D-05,+1.556D-05,+1.376D-05,+9.037D-06/
  data a3/-1.659D-06,-1.181D-05,-2.184D-05,-3.021D-05,-3.545D-05,-3.548D-05,-2.890D-05/
  data a4/-1.789D-06,+6.771D-06,+1.673D-05,+2.582D-05,+3.249D-05,+3.449D-05,+3.019D-05/
  data a5/+1.192D-06,-1.427D-06,-4.894D-06,-8.238D-06,-1.089D-05,-1.199D-05,-1.091D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjmvka = zf1*jphi + zf*jplo 

end function fjmvka

!**********************************************************************************************************************!
! fjmvkb  -function to calculate photolysis frequency (1/s) for the reaction
!
!         MVK + hv --> CH3CO + CH2=CH2
!         methyl vinyl ketone
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjmvkb(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjmvkb
  
  data a0/+1.826D-08,+2.205D-08,+2.255D-08,+2.108D-08,+1.850D-08,+1.610D-08,+1.628D-08/
  data a1/+4.065D-07,+2.043D-07,+1.444D-07,+3.082D-07,+7.905D-07,+1.693D-06,+3.043D-06/
  data a2/+4.191D-06,+8.727D-06,+1.237D-05,+1.483D-05,+1.556D-05,+1.376D-05,+9.037D-06/
  data a3/-1.659D-06,-1.181D-05,-2.184D-05,-3.021D-05,-3.545D-05,-3.548D-05,-2.890D-05/
  data a4/-1.789D-06,+6.771D-06,+1.673D-05,+2.582D-05,+3.249D-05,+3.449D-05,+3.019D-05/
  data a5/+1.192D-06,-1.427D-06,-4.894D-06,-8.238D-06,-1.089D-05,-1.199D-05,-1.091D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjmvkb = zf1*jphi + zf*jplo 

end function fjmvkb

!**********************************************************************************************************************!
! fjglyoxa  -function to calculate photolysis frequency (1/s) for the reaction
!
!         CHOCHO + hv --> 2CO + H2
!         glyoxal
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjglyoxa(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjglyoxa
  
  data a0/+3.772D-08,+4.850D-08,+5.171D-08,+4.976D-08,+4.393D-08,+3.658D-08,+3.226D-08/
  data a1/+9.435D-07,+3.161D-07,-1.007D-07,-9.776D-08,+5.753D-07,+2.203D-06,+4.926D-06/
  data a2/+9.010D-06,+2.011D-05,+3.042D-05,+3.916D-05,+4.481D-05,+4.524D-05,+3.904D-05/
  data a3/+4.647D-06,-1.660D-05,-4.202D-05,-6.731D-05,-8.835D-05,-9.947D-05,-9.616D-05/
  data a4/-1.296D-05,+2.298D-06,+2.575D-05,+5.142D-05,+7.485D-05,+9.002D-05,+9.177D-05/
  data a5/+5.671D-06,+1.699D-06,-6.046D-06,-1.512D-05,-2.385D-05,-3.001D-05,-3.160D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjglyoxa = zf1*jphi + zf*jplo 

end function fjglyoxa

!**********************************************************************************************************************!
! fjglyoxb  -function to calculate photolysis frequency (1/s) for the reaction
!
!         CHOCHO + hv --> HCHO + CO
!         glyoxal
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjglyoxb(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjglyoxb
  
  data a0/+2.399D-07,+2.851D-07,+2.899D-07,+2.758D-07,+2.501D-07,+2.329D-07,+2.597D-07/
  data a1/+5.193D-06,+3.060D-06,+3.133D-06,+5.781D-06,+1.245D-05,+2.434D-05,+4.159D-05/
  data a2/+5.992D-05,+0.0001186,+0.0001614,+0.0001910,+0.0001985,+0.0001748,+0.0001159/
  data a3/-2.728D-05,-0.0001594,-0.0002785,-0.0003812,-0.0004442,-0.0004429,-0.0003623/
  data a4/-1.874D-05,+9.276D-05,+0.0002101,+0.0003220,+0.0004023,+0.0004256,+0.0003733/
  data a5/+1.386D-05,-2.032D-05,-6.089D-05,-0.0001021,-0.0001338,-0.0001469,-0.0001338/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjglyoxb = zf1*jphi + zf*jplo 

end function fjglyoxb

!**********************************************************************************************************************!
! fjglyoxc  -function to calculate photolysis frequency (1/s) for the reaction
!
!         CHOCHO + hv --> HCO + HCO
!         glyoxal
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjglyoxc(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjglyoxc
  
  data a0/+9.520D-07,+9.648D-07,+9.245D-07,+9.023D-07,+9.475D-07,+1.175D-06,+1.795D-06/
  data a1/+1.699D-05,+2.543D-05,+4.539D-05,+7.443D-05,+0.0001155,+0.0001696,+0.0002328/
  data a2/+0.0002703,+0.0004060,+0.0004215,+0.0003647,+0.0002258,-6.151D-06,-0.0003170/
  data a3/-0.0004279,-0.0008613,-0.0010210,-0.0010180,-0.0008326,-0.0004325,+0.0001659/
  data a4/+0.0002965,+0.0007498,+0.0009568,+0.0010120,+0.0008964,+0.0005728,+4.740D-05/
  data a5/-7.923D-05,-0.0002421,-0.0003243,-0.0003555,-0.0003279,-0.0002276,-5.423D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjglyoxc = zf1*jphi + zf*jplo 

end function fjglyoxc

!**********************************************************************************************************************!
! fjmglyox  -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH3COCHO + hv --> CH3CO + HCO
!         methyl glyoxal
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjmglyox(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjmglyox
  
  data a0/+1.692D-06,+1.784D-06,+1.710D-06,+1.676D-06,+1.790D-06,+2.378D-06,+4.203D-06/
  data a1/+2.801D-05,+3.444D-05,+7.028D-05,+0.0001337,+0.0002380,+0.0003912,+0.0006030/
  data a2/+0.0004289,+0.0007404,+0.0008221,+0.0007389,+0.0004187,-0.0001883,-0.0011310/
  data a3/-0.0006435,-0.0015680,-0.0020040,-0.0021000,-0.0016820,-0.0006362,+0.0011600/
  data a4/+0.0004140,+0.0013660,+0.0018940,+0.0021230,+0.0018670,+0.0010150,-0.0005633/
  data a5/-0.0001004,-0.0004404,-0.0006456,-0.0007539,-0.0006952,-0.0004292,+9.303D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjmglyox = zf1*jphi + zf*jplo 

end function fjmglyox

!**********************************************************************************************************************!
! fjbiacet  -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH3COCOCH3 + hv --> 2CH3CO
!         biacetyl
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjbiacet(cz, cz2, cz3, cz4, cz5, cz6, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5, cz6
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5, a6
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjbiacet
  
  data a0/+5.075D-06,+5.195D-06,+5.306D-06,+5.783D-06,+7.026D-06,+1.005D-05,+1.643D-05/
  data a1/+4.451D-05,+0.0001043,+0.0002929,+0.0005467,+0.0008658,+0.0012380,+0.0016060/
  data a2/+0.0022410,+0.0035970,+0.0032100,+0.0019680,+1.457D-05,-0.0025860,-0.0054320/
  data a3/-0.0058280,-0.0126300,-0.0132300,-0.0106300,-0.0055040,+0.0020070,+0.0107100/
  data a4/+0.0070570,+0.0193300,+0.0218300,+0.0189800,+0.0120300,+0.0010860,-0.0120700/
  data a5/-0.0042580,-0.0141700,-0.0167800,-0.0152000,-0.0104400,-0.0025430,+0.0072110/
  data a6/+0.0010290,+0.0040440,+0.0049480,+0.0045960,+0.0033010,+0.0010590,-0.0017670/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5 + a6(l)*cz6
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5+a6(lm1)*cz6
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjbiacet = zf1*jphi + zf*jplo 

end function fjbiacet

!**********************************************************************************************************************!
! fjch3ooh  -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH3OOH + hv --> CH3O + OH
!         methyl hydroperoxide
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjch3ooh(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjch3ooh
  
  data a0/+4.346D-08,+5.243D-08,+5.337D-08,+4.990D-08,+4.396D-08,+3.882D-08,+3.985D-08/
  data a1/+9.772D-07,+4.985D-07,+3.891D-07,+8.013D-07,+1.964D-06,+4.102D-06,+7.289D-06/
  data a2/+9.647D-06,+2.035D-05,+2.866D-05,+3.424D-05,+3.572D-05,+3.134D-05,+2.002D-05/
  data a3/-3.267D-06,-2.719D-05,-5.005D-05,-6.913D-05,-8.081D-05,-8.036D-05,-6.406D-05/
  data a4/-4.562D-06,+1.567D-05,+3.828D-05,+5.905D-05,+7.402D-05,+7.812D-05,+6.695D-05/
  data a5/+2.866D-06,-3.356D-06,-1.121D-05,-1.886D-05,-2.481D-05,-2.718D-05,-2.421D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjch3ooh = zf1*jphi + zf*jplo 

end function fjch3ooh

!**********************************************************************************************************************!
! fjch3no3  -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH3NO3 + hv --> CH3O + NO2
!         methyl nitrate
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjch3no3(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjch3no3
  
  data a0/+2.286D-09,+2.839D-09,+2.907D-09,+2.693D-09,+2.302D-09,+1.821D-09,+1.463D-09/
  data a1/+8.414D-08,+2.690D-08,-2.458D-08,-5.720D-08,-6.521D-08,-4.499D-08,+4.077D-09/
  data a2/+4.113D-07,+1.014D-06,+1.607D-06,+2.105D-06,+2.461D-06,+2.639D-06,+2.779D-06/
  data a3/+2.225D-06,+1.468D-06,+5.243D-08,-1.416D-06,-2.707D-06,-3.651D-06,-4.396D-06/
  data a4/-2.547D-06,-2.446D-06,-1.292D-06,+9.875D-08,+1.433D-06,+2.508D-06,+3.359D-06/
  data a5/+8.724D-07,+9.756D-07,+6.356D-07,+1.739D-07,-2.947D-07,-6.944D-07,-1.009D-06/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjch3no3 = zf1*jphi + zf*jplo 

end function fjch3no3

!**********************************************************************************************************************!
! fjc2h5no3  -function to calculate photolysis frequency (1/s) for the reaction
!
!         C2H5NO3 + hv --> C2H5O + NO2
!         ethyl nitrate
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjc2h5no3(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjc2h5no3
  
  data a0/+3.996D-09,+4.867D-09,+4.987D-09,+4.517D-09,+3.808D-09,+2.949D-09,+2.388D-09/
  data a1/+1.405D-07,+4.557D-08,-4.460D-08,-8.914D-08,-9.693D-08,-5.359D-08,+3.146D-08/
  data a2/+7.566D-07,+1.772D-06,+2.809D-06,+3.550D-06,+4.093D-06,+4.282D-06,+4.478D-06/
  data a3/+3.476D-06,+2.108D-06,-4.739D-07,-2.722D-06,-4.799D-06,-6.098D-06,-7.300D-06/
  data a4/-4.095D-06,-3.789D-06,-1.565D-06,+5.563D-07,+2.755D-06,+4.256D-06,+5.689D-06/
  data a5/+1.423D-06,+1.542D-06,+8.471D-07,+1.534D-07,-6.332D-07,-1.185D-06,-1.735D-06/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjc2h5no3 = zf1*jphi + zf*jplo 

end function fjc2h5no3

!**********************************************************************************************************************!
! fjnc3h7no3  -function to calculate photolysis frequency (1/s) for the reaction
!
!         n-C3H7NO3 + hv --> n-C3H7O + NO2
!         n-propyl nitrate
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjnc3h7no3(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjnc3h7no3
  
  data a0/+7.852D-09,+1.041D-08,+1.137D-08,+1.125D-08,+1.017D-08,+8.660D-09,+7.643D-09/
  data a1/+2.370D-07,+9.642D-08,-1.791D-08,-5.960D-08,+3.815D-08,+3.325D-07,+8.602D-07/
  data a2/+1.591D-06,+3.923D-06,+6.297D-06,+8.527D-06,+1.018D-05,+1.085D-05,+1.020D-05/
  data a3/+3.145D-06,-5.498D-07,-5.861D-06,-1.176D-05,-1.701D-05,-2.056D-05,-2.131D-05/
  data a4/-4.461D-06,-2.378D-06,+2.177D-06,+7.866D-06,+1.334D-05,+1.752D-05,+1.916D-05/
  data a5/+1.672D-06,+1.275D-06,-1.534D-07,-2.103D-06,-4.063D-06,-5.658D-06,-6.410D-06/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjnc3h7no3 = zf1*jphi + zf*jplo 

end function fjnc3h7no3

!**********************************************************************************************************************!
! fjic3h7no3  -function to calculate photolysis frequency (1/s) for the reaction
!
!         i-C3H7NO3 + hv --> i-C3H7O + NO2
!         isopropyl nitrate
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjic3h7no3(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjic3h7no3
  
  data a0/+7.592D-09,+9.173D-09,+9.096D-09,+8.186D-09,+6.764D-09,+5.255D-09,+4.135D-09/
  data a1/+2.505D-07,+6.836D-08,-7.116D-08,-1.479D-07,-1.423D-07,-5.650D-08,+1.300D-07/
  data a2/+1.540D-06,+3.516D-06,+5.188D-06,+6.504D-06,+7.290D-06,+7.532D-06,+7.535D-06/
  data a3/+5.474D-06,+2.333D-06,-1.928D-06,-6.144D-06,-9.477D-06,-1.170D-05,-1.297D-05/
  data a4/-6.834D-06,-5.438D-06,-1.801D-06,+2.394D-06,+6.015D-06,+8.760D-06,+1.041D-05/
  data a5/+2.435D-06,+2.321D-06,+1.214D-06,-2.279D-07,-1.536D-06,-2.596D-06,-3.231D-06/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjic3h7no3 = zf1*jphi + zf*jplo 

end function fjic3h7no3

!**********************************************************************************************************************!
! fjtc4h9no3  -function to calculate photolysis frequency (1/s) for the reaction
!
!         t-C4H9NO3 + hv --> t-C4H9O + NO2
!         t-butyl nitrate
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjtc4h9no3(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjtc4h9no3
  
  data a0/+1.894D-08,+2.730D-08,+3.145D-08,+3.208D-08,+2.942D-08,+2.407D-08,+1.805D-08/
  data a1/+5.860D-07,+6.299D-08,-4.678D-07,-8.393D-07,-8.849D-07,-3.961D-07,+7.858D-07/
  data a2/+4.954D-06,+1.231D-05,+2.067D-05,+2.924D-05,+3.700D-05,+4.251D-05,+4.449D-05/
  data a3/+1.365D-05,+3.946D-06,-1.358D-05,-3.486D-05,-5.697D-05,-7.608D-05,-8.822D-05/
  data a4/-1.864D-05,-1.535D-05,-1.258D-06,+1.850D-05,+4.066D-05,+6.134D-05,+7.604D-05/
  data a5/+6.886D-06,+7.104D-06,+2.952D-06,-3.614D-06,-1.138D-05,-1.896D-05,-2.463D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjtc4h9no3 = zf1*jphi + zf*jplo 

end function fjtc4h9no3

!**********************************************************************************************************************!
! fjnoaa  -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH3C(O)CH2NO3 + hv --> CH3C(O)CH2O + NO2
!         1-hydroxy-2-propanone nitrate
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjnoaa(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjnoaa
  
  data a0/+1.837D-08,+2.530D-08,+2.833D-08,+2.844D-08,+2.590D-08,+2.158D-08,+1.753D-08/
  data a1/+5.392D-07,+1.260D-07,-2.556D-07,-4.712D-07,-3.687D-07,+2.203D-07,+1.408D-06/
  data a2/+4.343D-06,+1.058D-05,+1.731D-05,+2.390D-05,+2.942D-05,+3.269D-05,+3.276D-05/
  data a3/+9.562D-06,+4.236D-07,-1.420D-05,-3.107D-05,-4.758D-05,-6.061D-05,-6.709D-05/
  data a4/-1.371D-05,-9.472D-06,+2.703D-06,+1.864D-05,+3.551D-05,+5.009D-05,+5.891D-05/
  data a5/+5.136D-06,+4.700D-06,+9.973D-07,-4.365D-06,-1.034D-05,-1.578D-05,-1.934D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjnoaa = zf1*jphi + zf*jplo 

end function fjnoaa

!**********************************************************************************************************************!
! fjnoab  -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH3C(O)CH2NO3 + hv --> CH3CO + HCHO + NO2
!         1-hydroxy-2-propanone nitrate
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjnoab(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjnoab
  
  data a0/+5.205D-09,+7.487D-09,+8.887D-09,+9.317D-09,+9.013D-09,+8.114D-09,+6.975D-09/
  data a1/+2.126D-07,+9.487D-08,-5.808D-08,-1.696D-07,-2.109D-07,-1.226D-07,+1.404D-07/
  data a2/+7.017D-07,+2.343D-06,+4.590D-06,+6.925D-06,+9.215D-06,+1.104D-05,+1.208D-05/
  data a3/+6.389D-06,+5.452D-06,+1.336D-06,-3.902D-06,-9.835D-06,-1.531D-05,-1.926D-05/
  data a4/-6.803D-06,-7.907D-06,-5.020D-06,-5.569D-07,+4.999D-06,+1.048D-05,+1.473D-05/
  data a5/+2.239D-06,+3.022D-06,+2.271D-06,+8.760D-07,-9.802D-07,-2.896D-06,-4.440D-06/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjnoab = zf1*jphi + zf*jplo 

end function fjnoab

!**********************************************************************************************************************!
! fjhoch2cho  -function to calculate photolysis frequency (1/s) for the reaction
!
!         HOCH2CHO + hv --> HCO + HCHO + HO2
!         glycolaldehyde
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjhoch2cho(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjhoch2cho
  
  data a0/+1.258D-08,+1.810D-08,+2.114D-08,+2.204D-08,+2.080D-08,+1.787D-08,+1.448D-08/
  data a1/+4.319D-07,+1.089D-07,-2.510D-07,-5.272D-07,-5.993D-07,-3.359D-07,+3.536D-07/
  data a2/+2.591D-06,+7.080D-06,+1.255D-05,+1.836D-05,+2.375D-05,+2.781D-05,+2.990D-05/
  data a3/+1.207D-05,+7.491D-06,-3.255D-06,-1.704D-05,-3.174D-05,-4.484D-05,-5.418D-05/
  data a4/-1.456D-05,-1.459D-05,-6.506D-06,+5.829D-06,+2.012D-05,+3.380D-05,+4.440D-05/
  data a5/+5.097D-06,+6.055D-06,+3.815D-06,-1.723D-07,-5.075D-06,-9.985D-06,-1.395D-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjhoch2cho = zf1*jphi + zf*jplo 

end function fjhoch2cho

!**********************************************************************************************************************!
! fjacetol  -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH2(OH)COCH3 + hv --> CH3CO + HCHO + HO2
!         hydroxyacetone
!         (acetol)
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjacetol(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjacetol
  
  data a0/+3.901D-09,+5.227D-09,+5.750D-09,+5.636D-09,+5.070D-09,+4.203D-09,+3.485D-09/
  data a1/+1.178D-07,+4.340D-08,-2.088D-08,-4.239D-08,-1.423D-09,+1.449D-07,+4.182D-07/
  data a2/+8.724D-07,+2.088D-06,+3.355D-06,+4.500D-06,+5.440D-06,+5.845D-06,+5.518D-06/
  data a3/+1.490D-06,-4.314D-07,-3.284D-06,-6.276D-06,-9.241D-06,-1.125D-05,-1.166D-05/
  data a4/-2.151D-06,-1.067D-06,+1.411D-06,+4.261D-06,+7.375D-06,+9.735D-06,+1.061D-05/
  data a5/+8.111D-07,+6.041D-07,-1.853D-07,-1.148D-06,-2.276D-06,-3.181D-06,-3.575D-06/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjacetol = zf1*jphi + zf*jplo 

end function fjacetol

!**********************************************************************************************************************!
! fjpaa  -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH3C(O)OOH + hv --> CH3O2 + OH
!         peroxyacetic acid
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjpaa(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjpaa
  
  data a0/+4.011D-09,+5.221D-09,+5.620D-09,+5.436D-09,+4.805D-09,+3.977D-09,+3.399D-09/
  data a1/+1.047D-07,+3.535D-08,-1.631D-08,-2.385D-08,+3.932D-08,+2.053D-07,+4.931D-07/
  data a2/+9.502D-07,+2.146D-06,+3.309D-06,+4.320D-06,+5.022D-06,+5.173D-06,+4.600D-06/
  data a3/+7.238D-07,-1.462D-06,-4.262D-06,-7.109D-06,-9.580D-06,-1.103D-05,-1.091D-05/
  data a4/-1.580D-06,-9.187D-08,+2.452D-06,+5.304D-06,+8.006D-06,+9.870D-06,+1.029D-05/
  data a5/+6.626D-07,+2.974D-07,-5.339D-07,-1.533D-06,-2.531D-06,-3.273D-06,-3.526D-06/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjpaa = zf1*jphi + zf*jplo 

end function fjpaa

!**********************************************************************************************************************!
! fjpyra  -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH3COCOOH + hv --> CH3O3 + HO2
!         pyruvic acid
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjpyra(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjpyra
  
  data a0/+4.807D-06,+5.286D-06,+5.046D-06,+4.582D-06,+4.163D-06,+4.175D-06,+5.319D-06/
  data a1/+9.071D-05,+7.254D-05,+0.0001133,+0.0002153,+0.0003931,+0.0006618,+0.0010120/
  data a2/+0.0010350,+0.0019660,+0.0024170,+0.0024500,+0.0019970,+0.0009242,-0.0007661/
  data a3/-0.0013520,-0.0039060,-0.0055580,-0.0063240,-0.0060470,-0.0043530,-0.0011570/
  data a4/+0.0006754,+0.0031900,+0.0050480,+0.0061250,+0.0062440,+0.0049960,+0.0022380/
  data a5/-0.0001042,-0.0009717,-0.0016710,-0.0021160,-0.0022410,-0.0018880,-0.0009910/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjpyra = zf1*jphi + zf*jplo 

end function fjpyra

!**********************************************************************************************************************!
! fjhpald  -function to calculate photolysis frequency (1/s) for the reaction
!
!         HPALD + hv --> Products
!         hydroperoxyaldehydes
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjhpald(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjhpald
  
  data a0/+6.571D-06,+7.390D-06,+7.174D-06,+6.558D-06,+5.893D-06,+5.685D-06,+6.906D-06/
  data a1/+0.0001295,+9.449D-05,+0.0001333,+0.0002545,+0.0004821,+0.0008420,+0.0013230/
  data a2/+0.0014390,+0.0027870,+0.0035560,+0.0037920,+0.0033670,+0.0020660,-0.0001210/
  data a3/-0.0016270,-0.0051620,-0.0077230,-0.0092330,-0.0093680,-0.0075380,-0.0035960/
  data a4/+0.0006247,+0.0040030,+0.0067830,+0.0086940,+0.0093740,+0.0081840,+0.0049020/
  data a5/-2.929D-05,-0.0011700,-0.0021940,-0.0029530,-0.0033070,-0.0030130,-0.0019750/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjhpald = zf1*jphi + zf*jplo 

end function fjhpald

!**********************************************************************************************************************!
! fjacro -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH2CHCHO + hv --> Products
!         acrolein
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjacro(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjacro
  
  data a0/+4.293E-08,+5.151E-08,+5.441E-08,+5.526E-08,+5.704E-08,+6.528E-08,+9.877E-08/
  data a1/+8.221E-07,+6.955E-07,+1.148E-06,+2.431E-06,+5.084E-06,+1.003E-05,+1.872E-05/
  data a2/+9.416E-06,+1.940E-05,+2.656E-05,+3.068E-05,+2.965E-05,+1.848E-05,-8.683E-06/
  data a3/-1.158E-05,-3.728E-05,-5.939E-05,-7.696E-05,-8.602E-05,-7.574E-05,-3.410E-05/
  data a4/+5.286E-06,+2.975E-05,+5.309E-05,+7.352E-05,+8.745E-05,+8.452E-05,+5.331E-05/
  data a5/-6.427E-07,-8.903E-06,-1.738E-05,-2.520E-05,-3.112E-05,-3.153E-05,-2.241E-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjacro = zf1*jphi + zf*jplo 

end function fjacro

!**********************************************************************************************************************!
! fjhmhp -function to calculate photolysis frequency (1/s) for the reaction
!
!         HOCH2OOH -> HOCH2O + OH
!         hydroxy methyl hydroperoxide 
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjhmhp(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjhmhp
  
  data a0/+4.027E-08,+4.881E-08,+4.987E-08,+4.669E-08,+4.108E-08,+3.598E-08,+3.633E-08/
  data a1/+9.138E-07,+4.566E-07,+3.280E-07,+6.795E-07,+1.724E-06,+3.702E-06,+6.665E-06/
  data a2/+8.918E-06,+1.891E-05,+2.684E-05,+3.230E-05,+3.403E-05,+3.009E-05,+1.970E-05/
  data a3/-2.645E-06,-2.480E-05,-4.649E-05,-6.487E-05,-7.666E-05,-7.653E-05,-6.183E-05/
  data a4/-4.701E-06,+1.388E-05,+3.531E-05,+5.523E-05,+7.012E-05,+7.415E-05,+6.427E-05/
  data a5/+2.834E-06,-2.833E-06,-1.027E-05,-1.760E-05,-2.349E-05,-2.575E-05,-2.318E-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjhmhp = zf1*jphi + zf*jplo 

end function fjhmhp

!**********************************************************************************************************************!
! fjneth -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH2(OH)CH2(ONO2) -> CH2(OH)CH2O + NO2
!         nitroxy ethanol
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjneth(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjneth
  
  data a0/-1.943E-11,-3.422E-11,-3.959E-11,-4.053E-11,-3.640E-11,-2.853E-11,-1.961E-11/
  data a1/+2.777E-09,+5.263E-09,+6.766E-09,+7.801E-09,+8.286E-09,+8.449E-09,+8.672E-09/
  data a2/-2.037E-08,-4.637E-08,-6.443E-08,-7.877E-08,-8.844E-08,-9.584E-08,-1.053E-07/
  data a3/+3.421E-08,+1.194E-07,+1.876E-07,+2.490E-07,+3.003E-07,+3.501E-07,+4.167E-07/
  data a4/+8.064E-08,+9.489E-09,-5.998E-08,-1.299E-07,-1.938E-07,-2.588E-07,-3.443E-07/
  data a5/-4.654E-08,-2.915E-08,-7.032E-09,+1.757E-08,+4.128E-08,+6.626E-08,+9.978E-08/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjneth = zf1*jphi + zf*jplo 

end function fjneth

!**********************************************************************************************************************!
! fjnacet -function to calculate photolysis frequency (1/s) for the reaction
!
!         CH3COCH2(ONO2) + hv -> CH3COCH2O + NO2
!         nitroxy acetone
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjnacet(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjnacet
  
  data a0/+1.090E-07,+1.499E-07,+1.665E-07,+1.661E-07,+1.477E-07,+1.188E-07,+9.143E-08/
  data a1/+3.035E-06,+4.833E-07,-1.740E-06,-2.998E-06,-2.167E-06,+1.654E-06,+9.123E-06/
  data a2/+2.877E-05,+6.758E-05,+1.079E-04,+1.474E-04,+1.790E-04,+1.960E-04,+1.934E-04/
  data a3/+4.379E-05,-1.882E-05,-1.098E-04,-2.138E-04,-3.118E-04,-3.858E-04,-4.199E-04/
  data a4/-7.260E-05,-3.757E-05,+4.070E-05,+1.412E-04,+2.435E-04,+3.286E-04,+3.788E-04/
  data a5/+2.857E-05,+2.238E-05,-2.069E-06,-3.641E-05,-7.320E-05,-1.053E-04,-1.262E-04/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjnacet = zf1*jphi + zf*jplo 

end function fjnacet

!**********************************************************************************************************************!
! fjpana -function to calculate photolysis frequency (1/s) for the reaction
!
!         PAN + hv -> CH3CO(OO) + NO2
!         peroxy acetyl nitrate (PAN)
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjpana(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjpana
  
  data a0/+2.171E-09,+2.426E-09,+2.260E-09,+1.916E-09,+1.502E-09,+1.114E-09,+9.289E-10/
  data a1/+5.778E-08,+2.024E-08,-1.423E-09,-3.948E-09,+1.472E-08,+5.507E-08,+1.193E-07/
  data a2/+4.788E-07,+9.472E-07,+1.272E-06,+1.455E-06,+1.483E-06,+1.340E-06,+1.128E-06/
  data a3/+4.589E-07,-5.276E-07,-1.502E-06,-2.253E-06,-2.685E-06,-2.705E-06,-2.510E-06/
  data a4/-8.556E-07,-1.373E-07,+8.133E-07,+1.642E-06,+2.208E-06,+2.379E-06,+2.321E-06/
  data a5/+3.464E-07,+1.579E-07,-1.654E-07,-4.688E-07,-6.939E-07,-7.831E-07,-7.882E-07/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjpana = zf1*jphi + zf*jplo 

end function fjpana

!**********************************************************************************************************************!
! fjpanb -function to calculate photolysis frequency (1/s) for the reaction
!
!         PAN + hv -> CH3CO(O) + NO3
!         peroxy acetyl nitrate (PAN)
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjpanb(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjpanb
  
  data a0/+1.447E-09,+1.618E-09,+1.506E-09,+1.277E-09,+9.929E-10,+7.445E-10,+6.134E-10/
  data a1/+3.857E-08,+1.336E-08,-8.033E-10,-2.369E-09,+1.074E-08,+3.665E-08,+7.995E-08/
  data a2/+3.189E-07,+6.327E-07,+8.466E-07,+9.673E-07,+9.799E-07,+8.938E-07,+7.491E-07/
  data a3/+3.063E-07,-3.559E-07,-9.968E-07,-1.494E-06,-1.763E-06,-1.804E-06,-1.665E-06/
  data a4/-5.704E-07,-8.625E-08,+5.363E-07,+1.085E-06,+1.438E-06,+1.587E-06,+1.538E-06/
  data a5/+2.308E-07,+1.030E-07,-1.076E-07,-3.092E-07,-4.483E-07,-5.219E-07,-5.220E-07/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjpanb = zf1*jphi + zf*jplo 

end function fjpanb

!**********************************************************************************************************************!
! fjppna -function to calculate photolysis frequency (1/s) for the reaction
!
!         PPN + hv -> CH3CH2CO(OO) + NO2
!         peroxy propionyl nitrate (PPN)
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjppna(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjppna
  
  data a0/+3.261E-09,+3.427E-09,+2.988E-09,+2.343E-09,+1.692E-09,+1.136E-09,+8.425E-10/
  data a1/+8.927E-08,+2.228E-08,-1.610E-08,-2.391E-08,-8.695E-09,+2.634E-08,+8.235E-08/
  data a2/+7.840E-07,+1.423E-06,+1.792E-06,+1.916E-06,+1.860E-06,+1.634E-06,+1.432E-06/
  data a3/+8.962E-07,-5.664E-07,-1.895E-06,-2.739E-06,-3.157E-06,-3.103E-06,-2.972E-06/
  data a4/-1.593E-06,-5.195E-07,+8.351E-07,+1.839E-06,+2.469E-06,+2.630E-06,+2.653E-06/
  data a5/+6.370E-07,+3.600E-07,-1.084E-07,-4.860E-07,-7.467E-07,-8.442E-07,-8.817E-07/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjppna = zf1*jphi + zf*jplo 

end function fjppna

!**********************************************************************************************************************!
! fjppnb -function to calculate photolysis frequency (1/s) for the reaction
!
!         PPN + hv -> CH3CH2CO(O) + NO3
!         peroxy propionyl nitrate (PPN)
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjppnb(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjppnb
  
  data a0/+2.080E-09,+2.189E-09,+1.912E-09,+1.498E-09,+1.080E-09,+7.243E-10,+5.372E-10/
  data a1/+5.773E-08,+1.435E-08,-1.039E-08,-1.537E-08,-5.261E-09,+1.692E-08,+5.269E-08/
  data a2/+4.948E-07,+9.083E-07,+1.146E-06,+1.226E-06,+1.186E-06,+1.045E-06,+9.155E-07/
  data a3/+5.924E-07,-3.569E-07,-1.214E-06,-1.754E-06,-2.011E-06,-1.987E-06,-1.900E-06/
  data a4/-1.042E-06,-3.394E-07,+5.377E-07,+1.179E-06,+1.571E-06,+1.688E-06,+1.697E-06/
  data a5/+4.168E-07,+2.334E-07,-7.086E-08,-3.120E-07,-4.745E-07,-5.432E-07,-5.638E-07/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjppnb = zf1*jphi + zf*jplo 

end function fjppnb

!**********************************************************************************************************************!
! fjn2o5a -function to calculate photolysis frequency (1/s) for the reaction
!
!         N2O5 + hv -> NO3 + NO + O(3P)
!         dinitrogen pentoxide
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjn2o5a(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjn2o5a
  
  data a0/+2.488E-12,+3.831E-12,+4.432E-12,+4.685E-12,+4.703E-12,+4.742E-12,+5.297E-12/
  data a1/-2.240E-10,-3.965E-10,-4.862E-10,-5.366E-10,-5.589E-10,-5.876E-10,-6.966E-10/
  data a2/+1.841E-09,+3.702E-09,+4.742E-09,+5.389E-09,+5.751E-09,+6.203E-09,+7.610E-09/
  data a3/-3.673E-09,-1.020E-08,-1.414E-08,-1.683E-08,-1.860E-08,-2.075E-08,-2.652E-08/
  data a4/-1.508E-09,+7.095E-09,+1.279E-08,+1.708E-08,+2.029E-08,+2.407E-08,+3.277E-08/
  data a5/+6.797E-09,+3.686E-09,+1.277E-09,-7.785E-10,-2.508E-09,-4.364E-09,-7.582E-09/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjn2o5a = zf1*jphi + zf*jplo 

end function fjn2o5a

!**********************************************************************************************************************!
! fjn2o5b -function to calculate photolysis frequency (1/s) for the reaction
!
!         N2O5 + hv -> NO3 + NO2
!         dinitrogen pentoxide
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjn2o5b(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjn2o5b
  
  data a0/+3.533E-07,+3.542E-07,+2.989E-07,+2.301E-07,+1.641E-07,+1.172E-07,+1.157E-07/
  data a1/+7.836E-06,+3.490E-06,+2.133E-06,+3.121E-06,+5.929E-06,+1.014E-05,+1.912E-05/
  data a2/+7.951E-05,+1.387E-04,+1.626E-04,+1.616E-04,+1.412E-04,+1.102E-04,+8.258E-05/
  data a3/-2.952E-05,-1.801E-04,-2.734E-04,-3.110E-04,-2.999E-04,-2.578E-04,-2.237E-04/
  data a4/-3.338E-05,+1.011E-04,+2.046E-04,+2.591E-04,+2.667E-04,+2.417E-04,+2.219E-04/
  data a5/+2.184E-05,-2.089E-05,-5.903E-05,-8.151E-05,-8.786E-05,-8.251E-05,-7.812E-05/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjn2o5b = zf1*jphi + zf*jplo 

end function fjn2o5b

!**********************************************************************************************************************!
! fjbald  -function to calculate photolysis frequency (1/s) for the reaction
!
!         BenzALD + hv --> HCO + HO2 + CO
!         benzaldehyde (as in RACM2)
!
!         for a given cosine(zenith angle) and altitude above mean sea level.
!         fourth-order polynomials of cosine(zenith angle) at each of 7 levels
!         1=0km, 2=2km, 3=4km, 4=6km, 5=8km, 6=10km, 7=12km
!         Derived from TUV5.0, http://http://cprm.acd.ucar.edu/Models/TUV/
!         (Madronich and Flocke, 1997)
!**********************************************************************************************************************!
function fjbald(cz, cz2, cz3, cz4, cz5, l, lm1, zf, zf1)
  integer(kind=i4) :: l, lm1
  real(kind=dp)    :: cz, cz2, cz3, cz4, cz5
  real(kind=dp)    :: zf, zf1
  integer(kind=i4), parameter :: nalts=7
  real(kind=dp), dimension(nalts) :: a0, a1, a2, a3, a4, a5
  real(kind=dp)    :: jphi, jplo
  real(kind=dp)    :: fjbald
  
  data a0/+1.521E-06,+1.757E-06,+1.725E-06,+1.582E-06,+1.395E-06,+1.297E-06,+1.472E-06/
  data a1/+3.165E-05,+2.031E-05,+2.538E-05,+4.854E-05,+9.779E-05,+1.785E-04,+2.915E-04/
  data a2/+3.251E-04,+6.559E-04,+8.630E-04,+9.632E-04,+9.054E-04,+6.452E-04,+1.549E-04/
  data a3/-3.111E-04,-1.144E-03,-1.790E-03,-2.251E-03,-2.390E-03,-2.084E-03,-1.238E-03/
  data a4/+6.840E-05,+8.439E-04,+1.522E-03,+2.075E-03,+2.343E-03,+2.195E-03,+1.516E-03/
  data a5/+2.097E-05,-2.360E-04,-4.802E-04,-6.951E-04,-8.171E-04,-7.969E-04,-5.886E-04/

  ! polynomial value at l (highest altitude)
  jphi = a0(l) + a1(l)*cz + a2(l)*cz2 + a3(l)*cz3 + a4(l)*cz4 + a5(l)*cz5
  jphi = max(0.0D0, jphi)   ! no negative values

  ! polynomial value at lm1 (lowest altitude)
  jplo = a0(lm1)+a1(lm1)*cz+a2(lm1)*cz2+a3(lm1)*cz3+a4(lm1)*cz4+a5(lm1)*cz5
  jplo = max(0.0D0, jplo)   ! no negative values

  ! interpolate to required altitude
  fjbald = zf1*jphi + zf*jplo 

end function fjbald

!**********************************************************************************************************************!
! GasThermalRateCoeffs - calculates thermal rate coefficients
!**********************************************************************************************************************!
subroutine GasThermalRateCoeffs(ts, k)
  real(kind=dp), dimension(nrxn) :: k
  real(kind=dp) :: ts  ! not used yet
  real(kind=dp) :: TEMP, AIR, N2, O2, H2, PPA, H2Oz

  ! thermal reaction rate coefficients (units: molecules-cm3-s)
  TEMP = tk(zpt)
  AIR  = cair(zpt)
  H2 = 500.0E-9*cair(zpt)        ! molecular hydrogen
  N2 = 0.78*cair(zpt)            ! diatomic nitrogen
  O2 = 0.21*cair(zpt)            ! diatomic oxygen
  H2Oz = h2o(zpt) 
  PPA = pmb(zpt)*100._dp   ! PPA = air pressure in Pascals

  ! Generated by chmgen for mechanism racm2_plus
  k(59)    = 1.7D-12*EXP(-940./TEMP)
  k(60)    = 1.0D-14*EXP(-490./TEMP)
  k(61)    = 1.4D-12*EXP(-1310./TEMP)
  k(62)    = 1.4D-13*EXP(-2470./TEMP)
  k(63)    = 5.6D-34*N2*(TEMP/300.)**(-2.6)*O2+6.0D-34*O2*(TEMP/300.)**(-2.6)*O2
  k(64)    = 8.0D-12*EXP(-2060./TEMP)
  k(65)    = 3.2D-11*EXP(-67./TEMP)
  k(66)    = 2.0D-11*EXP(130./TEMP)
  k(67)    = H2Oz*2.14D-10
  k(68)    = 7.70D-12*EXP(-2100./TEMP)
  k(69)    = 4.8D-11*EXP(250./TEMP)
  k(70)    = 2.2D-13*EXP(600./TEMP)+1.90D-33*AIR*EXP(980./TEMP)
  k(71)    = (3.08D-34*EXP(2800./TEMP)+2.59D-54*AIR*EXP(3180./TEMP))*H2Oz
  k(72)    = 2.9D-12*EXP(-160./TEMP)
  k(73)    = TJPL(9.0D-32,1.5D0,3.0D-11,0.0D0,TEMP,AIR)
  k(74)    = TJPL(7.0D-31,2.6D0,3.6D-11,0.1D0,TEMP,AIR)
  k(75)    = 3.45D-12*EXP(270./TEMP)
  k(76)    = (3.45D-12*EXP(270./TEMP))*((530./TEMP)+(4.8D-6*PPA)-1.73)/100.
  k(77)    = 3.3D-39*EXP(530./TEMP)
  k(78)    = 2.5D-12*EXP(260./TEMP)
  k(79)    = 5.5D-12*EXP(188./TEMP)
  k(80)    = TJPL(2.5D-31,1.8D0,2.2D-11,0.7D0,TEMP,AIR)
  k(81)    = TJPL(1.51D-30,3.0D0,2.58D-11,0.0D0,TEMP,AIR)
  k(82)    = KTYP2(2.4D-14,460.0D0,2.7D-17,2199.0D0,6.5D-34,1335.0D0,TEMP,AIR)
  k(83)    = 2.0D-11
  k(84)    = 4.0D-12
  k(85)    = 1.8D-11*EXP(110./TEMP)
  k(86)    = 4.5D-14*EXP(-1260./TEMP)
  k(87)    = 8.5D-13*EXP(-2450./TEMP)
  k(88)    = TJPL(2.0D-30,4.4D0,1.4D-12,0.7D0,TEMP,AIR)
  k(89)    = TJPL(2.0D-30,4.4D0,1.4D-12,0.7D0,TEMP,AIR)/(2.7D-27*EXP(11000./TEMP))
  k(90)    = H2Oz*1.0D-22
  k(91)    = TJPL(2.0D-31,3.4D0,2.9D-12,1.1D0,TEMP,AIR)
  k(92)    = TJPL(2.0D-31,3.4D0,2.9D-12,1.1D0,TEMP,AIR)/(2.1D-27*EXP(10900./TEMP))
  k(93)    = 1.3D-12*EXP(380/TEMP)
  k(94)    = TJPL(3.3D-31,4.3D0,1.6D-12,0.0D0,TEMP,AIR)
  k(95)    = TERCO(1.5D-13,0.6D0,2.1D+9,6.1D0,TEMP,AIR)+TJPL(5.9D-33,1.4D0,1.1D-12,-1.3D0,TEMP,AIR)
  k(96)    = 1.85D-12*EXP(-1690./TEMP)
  k(97)    = 6.90D-12*EXP(-1000./TEMP)
  k(98)    = 7.68D-12*EXP(-370./TEMP)
  k(99)    = 1.01D-11*EXP(-245./TEMP)
  k(100)   = 2.82D-11*EXP(-273./TEMP)
  k(101)   = TJPL(1.0D-28,4.5D0,8.8D-12,0.85D0,TEMP,AIR)
  k(102)   = 5.72D-12*EXP(500./TEMP)
  k(103)   = 1.33D-11*EXP(500./TEMP)
  k(104)   = 1.48D-11*EXP(448./TEMP)
  k(105)   = TJPL(5.5D-30,0.0D0,8.3D-13,-2.0D0,TEMP,AIR)
  k(106)   = 2.33D-12*EXP(-193./TEMP)
  k(107)   = 1.81D-12*EXP(354./TEMP)
  k(108)   = 2.31D-11
  k(109)   = 1.43D-11
  k(110)   = 1.36D-11
  k(111)   = 3.1D-11*EXP(350.0/TEMP)
  k(112)   = 1.21D-11*EXP(440./TEMP)
  k(113)   = 4.20D-11*EXP(401./TEMP)
  k(114)   = 5.50D-12*EXP(125./TEMP)
  k(115)   = 4.70D-12*EXP(345./TEMP)
  k(116)   = 4.90D-12 *EXP(405./TEMP)
  k(117)   = 1.39D-13+3.72D-11*EXP(-2044./TEMP)
  k(118)   = 1.5D-12*EXP(-90./TEMP)
  k(119)   = 2.8D-12*EXP(10./TEMP)
  k(120)   = 3.0D-12
  k(121)   = 8.0D-12*EXP(380.0/TEMP)
  k(122)   = 2.60D-12*EXP(610./TEMP)
  k(123)   = 5.77D-12*EXP(533./TEMP)
  k(124)   = 1.1D-11
  k(125)   = 9.26D-13*EXP(830./TEMP)
  k(126)   = 2.8D-11*EXP(175./TEMP)
  k(127)   = 2.8D-11*EXP(175./TEMP)
  k(128)   = 1.00D-11
  k(129)   = 5.32D-12*EXP(243./TEMP)
  k(130)   = 6.75D-12*EXP(405./TEMP)
  k(131)   = 4.65D-11
  k(132)   = 2.8D-11*EXP(175./TEMP)
  k(133)   = 2.05D-10
  k(134)   = 2.85D-12*EXP(-345./TEMP)
  k(135)   = 3.0D-12*EXP(20./TEMP)
  k(136)   = 2.6D-12*EXP(200./TEMP)
  k(137)   = 1.47D-11
  k(138)   = 2.9D-12*EXP(190./TEMP)
  k(139)   = 3.40D-12*EXP(190./TEMP)
  k(140)   = 1.9D-11*EXP(390./TEMP)
  k(141)   = 3.8D-12*EXP(200./TEMP)
  k(142)   = 1.66D-11
  k(143)   = 4.5D-13
  k(144)   = 4.0D-14*EXP(850./TEMP)
  k(145)   = 2.93D-12*EXP(190./TEMP)
  k(146)   = 4.0D-14
  k(147)   = 4.0D-14
  k(148)   = 3.2D-11
  k(149)   = 5.31D-12*EXP(-260./TEMP)
  k(150)   = 5.6D-12*EXP(270./TEMP)
  k(151)   = 9.14D-15*EXP(-2580./TEMP)
  k(152)   = 4.33D-15*EXP(-1800./TEMP)
  k(153)   = 4.40D-15*EXP(-845./TEMP)
  k(154)   = 1.34D-14*EXP(-2283./TEMP)
  k(155)   = 7.86D-15*EXP(-1913./TEMP)
  k(156)   = 5.0D-16*EXP(-530./TEMP)
  k(157)   = 2.95D-15*EXP(-783./TEMP)
  k(158)   = 1.4D-15*EXP(-2100./TEMP)
  k(159)   = 8.5D-16*EXP(-1520./TEMP)
  k(160)   = 1.66D-18
  k(161)   = 2.0D-16
  k(162)   = 2.0D-16
  k(163)   = 9.0D-17
  k(164)   = 5.0D-16
  k(165)   = 2.86D-13
  k(166)   = TEMP*TEMP*4.88D-18*EXP(-2822/TEMP)
  k(167)   = 1.79D-13*EXP(-450./TEMP)
  k(168)   = 8.64D-13*EXP(450./TEMP)
  k(169)   = 1.0D-13
  k(170)   = 1.19D-12*EXP(490.0/TEMP)
  k(171)   = 1.22D-11
  k(172)   = 2.0D-12*EXP(-2440./TEMP)
  k(173)   = 1.4D-12*EXP(-1900./TEMP)
  k(174)   = 3.76D-12*EXP(-1900./TEMP)
  k(175)   = 3.4D-15
  k(176)   = 5.02D-13*EXP(-1076/TEMP)
  k(177)   = 2.90D-12*EXP(-1900./TEMP)
  k(178)   = 3.76D-12*EXP(-1900./TEMP)
  k(179)   = 3.78D-12
  k(180)   = 1.06D-12
  k(181)   = 2.87D-13*EXP(-1000./TEMP)
  k(182)   = 2.01D-10
  k(183)   = 2.2D-14*EXP(-500./TEMP)
  k(184)   = 1.0D+03
  k(185)   = 1.0D+03
  k(186)   = 1.0D+03
  k(187)   = 1.0D+03
  k(188)   = 1.0D+03
  k(189)   = 1.0D+03
  k(190)   = TJPL(9.7D-29,5.6D0,9.3D-12,1.5D0,TEMP,AIR)
  k(191)   = TJPL(9.7D-29,5.6D0,9.3D-12,1.5D0,TEMP,AIR)/(9.0D-29*EXP(14000./TEMP))
  k(192)   = TJPL(9.7D-29,5.6D0,9.3D-12,1.5D0,TEMP,AIR)
  k(193)   = TJPL(9.7D-29,5.6D0,9.3D-12,1.5D0,TEMP,AIR)/(9.0D-29*EXP(14000./TEMP))
  k(194)   = TJPL(9.0D-28,8.9D0,7.7D-12,0.2D0,TEMP,AIR)
  k(195)   = TJPL(9.0D-28,8.9D0,7.7D-12,0.2D0,TEMP,AIR)/(9.0D-29*EXP(14000./TEMP))
  k(196)   = 2.80D-12*EXP(300./TEMP)
  k(197)   = 2.6D-12*EXP(365./TEMP)
  k(198)   = 4.00D-12
  k(199)   = 4.00D-12
  k(200)   = 4.00D-12
  k(201)   = 9.0D-12
  k(202)   = 4.00D-12
  k(203)   = 4.00D-12
  k(204)   = 2.54D-12*EXP(360./TEMP)
  k(205)   = 4.0D-12
  k(206)   = 2.70D-12*EXP(360./TEMP)
  k(207)   = 2.70D-12*EXP(360./TEMP)
  k(208)   = 4.0D-12
  k(209)   = 2.70D-12*EXP(360./TEMP)
  k(210)   = 2.70D-12*EXP(360./TEMP)
  k(211)   = 2.70D-12*EXP(360./TEMP)
  k(212)   = 2.70D-12*EXP(360./TEMP)
  k(213)   = 4.00D-12
  k(214)   = 4.00D-12
  k(215)   = 8.1D-12*EXP(270./TEMP)
  k(216)   = 8.1D-12*EXP(270./TEMP)
  k(217)   = 2.9D-12*EXP(300./TEMP)
  k(218)   = 4.0D-12
  k(219)   = 4.00D-12
  k(220)   = 7.5D-12*EXP(290.0/TEMP)
  k(221)   = 2.54D-12*EXP(360./TEMP)
  k(222)   = 2.7D-12*EXP(360.0/TEMP)
  k(223)   = 2.54D-12*EXP(360./TEMP)
  k(224)   = 4.0D-12
  k(225)   = 4.0D-12
  k(226)   = 2.7D-12*EXP(360./TEMP)
  k(227)   = 2.7D-12*EXP(360./TEMP)
  k(228)   = 4.0D-12
  k(229)   = 4.0D-12
  k(230)   = 4.00D-12
  k(231)   = 4.00D-12
  k(232)   = 4.0D-12
  k(233)   = 4.00D-12
  k(234)   = 2.7D-12*EXP(360./TEMP)
  k(235)   = 4.0D-12
  k(236)   = 2.00D-11
  k(237)   = 2.00D-11
  k(238)   = 2.08D-12
  k(239)   = 4.1D-13*EXP(750./TEMP)
  k(240)   = 7.5D-13*EXP(700./TEMP)
  k(241)   = 1.66D-13*EXP(1300./TEMP)
  k(242)   = 1.66D-13*EXP(1300./TEMP)
  k(243)   = 1.66D-13*EXP(1300./TEMP)
  k(244)   = 1.90D-13*EXP(1300./TEMP)
  k(245)   = 1.66D-13*EXP(1300./TEMP)
  k(246)   = 1.66D-13*EXP(1300./TEMP)
  k(247)   = 2.91D-13*EXP(1300./TEMP)
  k(248)   = 3.75D-13*EXP(980./TEMP)
  k(249)   = 3.75D-13*EXP(980./TEMP)
  k(250)   = 3.75D-13*EXP(980./TEMP)
  k(251)   = 3.75D-13*EXP(980./TEMP)
  k(252)   = 3.75D-13*EXP(980./TEMP)
  k(253)   = 3.75D-13*EXP(980./TEMP)
  k(254)   = 3.75D-13*EXP(980./TEMP)
  k(255)   = 7.4D-13*EXP(700./TEMP)
  k(256)   = 1.5D-11
  k(257)   = 1.5D-11
  k(258)   = 4.3D-13*EXP(1040./TEMP)
  k(259)   = 4.3D-13*EXP(1040./TEMP)
  k(260)   = 1.15D-13*EXP(1300./TEMP)
  k(261)   = 1.15D-13*EXP(1300./TEMP)
  k(262)   = 1.15D-13*EXP(1300./TEMP)
  k(263)   = 5.2D-13*EXP(980./TEMP)
  k(264)   = 1.82D-13*EXP(1300./TEMP)
  k(265)   = 1.82D-13*EXP(1300./TEMP)
  k(266)   = 2.91D-13*EXP(1300./TEMP)
  k(267)   = 3.75D-13*EXP(980./TEMP)
  k(268)   = 1.00D-11
  k(269)   = 3.75D-13*EXP(980./TEMP)
  k(270)   = 1.15D-13*EXP(1300./TEMP)
  k(271)   = 1.66D-13*EXP(1300./TEMP)
  k(272)   = 1.66D-13*EXP(1300./TEMP)
  k(273)   = 1.66D-13*EXP(1300./TEMP)
  k(274)   = 1.66D-13*EXP(1300./TEMP)
  k(275)   = 3.75D-13*EXP(980.0/TEMP)
  k(276)   = 1.66D-13*EXP(1300./TEMP)
  k(277)   = 9.5D-14*EXP(390./TEMP)
  k(278)   = 1.18D-13*EXP(158./TEMP)
  k(279)   = 9.46D-14*EXP(431./TEMP)
  k(280)   = 1.0D-13*EXP(467./TEMP)
  k(281)   = 4.34D-14*EXP(633./TEMP)
  k(282)   = 1.71D-13*EXP(708./TEMP)
  k(283)   = 1.46D-13*EXP(708./TEMP)
  k(284)   = 9.18D-14*EXP(708./TEMP)
  k(285)   = 3.56D-14*EXP(708./TEMP)
  k(286)   = 3.56D-14*EXP(708./TEMP)
  k(287)   = 3.56D-14*EXP(708./TEMP)
  k(288)   = 3.56D-14*EXP(708./TEMP)
  k(289)   = 3.56D-14*EXP(708./TEMP)
  k(290)   = 3.56D-14*EXP(708./TEMP)
  k(291)   = 3.56D-14*EXP(708./TEMP)
  k(292)   = 3.56D-14*EXP(708./TEMP)
  k(293)   = 3.4D-14*EXP(221./TEMP)
  k(294)   = 3.56D-14*EXP(708./TEMP)
  k(295)   = 3.56D-14*EXP(708./TEMP)
  k(296)   = 2.0D-11*EXP(500./TEMP)
  k(297)   = 2.0D-11*EXP(500./TEMP)
  k(298)   = 7.5D-13*EXP(500./TEMP)
  k(299)   = 6.91D-13*EXP(508./TEMP)
  k(300)   = 6.91D-13*EXP(508./TEMP)
  k(301)   = 2.0D-12*EXP(500./TEMP)
  k(302)   = 3.4D-14*EXP(221./TEMP)
  k(303)   = 1.38D-12
  k(304)   = 3.4D-14*EXP(221./TEMP)
  k(305)   = 3.56D-14*EXP(708./TEMP)
  k(306)   = 3.56D-14*EXP(708./TEMP)
  k(307)   = 3.56D-14*EXP(708./TEMP)
  k(308)   = 3.56D-14*EXP(708./TEMP)
  k(309)   = 7.50D-13*EXP(500./TEMP)
  k(310)   = 1.60D-13*EXP(708./TEMP)
  k(311)   = 9.68D-14*EXP(708./TEMP)
  k(312)   = 1.60D-13*EXP(708./TEMP)
  k(313)   = 9.68D-14*EXP(708./TEMP)
  k(314)   = 3.56D-14
  k(315)   = 5.99D-15*EXP(1510./TEMP)
  k(316)   = 1.03D-12*EXP(211./TEMP)
  k(317)   = 6.9D-13*EXP(460./TEMP)
  k(318)   = 5.59D-13*EXP(522./TEMP)
  k(319)   = 2.47D-13*EXP(683./TEMP)
  k(320)   = 9.48D-13*EXP(765./TEMP)
  k(321)   = 8.11D-13*EXP(765./TEMP)
  k(322)   = 5.09D-13*EXP(765./TEMP)
  k(323)   = 7.4D-13*EXP(765./TEMP)
  k(324)   = 7.4D-13*EXP(765./TEMP)
  k(325)   = 7.4D-13*EXP(765./TEMP)
  k(326)   = 7.4D-13*EXP(765./TEMP)
  k(327)   = 7.4D-13*EXP(765./TEMP)
  k(328)   = 7.4D-13*EXP(765./TEMP)
  k(329)   = 7.4D-13*EXP(765./TEMP)
  k(330)   = 7.4D-13*EXP(765./TEMP)
  k(331)   = 8.4D-14*EXP(221./TEMP)
  k(332)   = 7.4D-13*EXP(765./TEMP)
  k(333)   = 7.4D-13*EXP(765./TEMP)
  k(334)   = 2.5D-12*EXP(500./TEMP)
  k(335)   = 2.5D-12*EXP(500./TEMP)
  k(336)   = 7.51D-13*EXP(565./TEMP)
  k(337)   = 7.51D-13*EXP(565./TEMP)
  k(338)   = 7.51D-13*EXP(565./TEMP)
  k(339)   = 2.9D-12*EXP(500./TEMP)
  k(340)   = 8.4D-14*EXP(221./TEMP)
  k(341)   = 1.7D-12*EXP(500./TEMP)
  k(342)   = 1.68D-12*EXP(500./TEMP)
  k(343)   = 7.4D-13*EXP(765./TEMP)
  k(344)   = 7.4D-13*EXP(765./TEMP)
  k(345)   = 7.4D-13 *EXP(708./TEMP)
  k(346)   = 7.4D-13 *EXP(708./TEMP)
  k(347)   = 7.51D-13*EXP(565./TEMP)
  k(348)   = 8.85D-13*EXP(765./TEMP)
  k(349)   = 8.85D-13*EXP(765./TEMP)
  k(350)   = 5.37D-13*EXP(765./TEMP)
  k(351)   = 5.37D-13*EXP(765./TEMP)
  k(352)   = 7.40D-13*EXP(708./TEMP)
  k(353)   = 3.4D-14*EXP(1560./TEMP)
  k(354)   = 2.50D-12*EXP(500./TEMP)
  k(355)   = 1.20D-12
  k(356)   = 1.2D-12
  k(357)   = 1.20D-12
  k(358)   = 1.20D-12
  k(359)   = 1.2D-12
  k(360)   = 1.2D-12
  k(361)   = 1.20D-12
  k(362)   = 1.20D-12
  k(363)   = 1.20D-12
  k(364)   = 1.2D-12
  k(365)   = 1.2D-12
  k(366)   = 1.2D-12
  k(367)   = 1.2D-12
  k(368)   = 1.2D-12
  k(369)   = 1.2D-12
  k(370)   = 1.2D-12
  k(371)   = 1.2D-12
  k(372)   = 1.2D-12
  k(373)   = 1.2D-12
  k(374)   = 4.0D-12
  k(375)   = 4.0D-12
  k(376)   = 1.2D-12
  k(377)   = 1.2D-12
  k(378)   = 1.2D-12
  k(379)   = 4.0D-12
  k(380)   = 1.2D-12
  k(381)   = 2.3D-12
  k(382)   = 2.5D-12
  k(383)   = 2.5D-12
  k(384)   = 2.5D-12
  k(385)   = 1.2D-12
  k(386)   = 1.2D-12
  k(387)   = 1.2D-12
  k(388)   = 1.20D-12
  k(389)   = 1.20D-12
  k(390)   = 1.2D-12
  k(391)   = 1.20D-12
  k(392)   = 1.2D-12
  k(393)   = 7.00D-14*EXP(1000./TEMP)
  k(394)   = 7.00D-14*EXP(1000./TEMP)
  k(395)   = 4.25D-14*EXP(1000./TEMP)
  k(396)   = 4.25D-14*EXP(1000./TEMP)
  k(397)   = 7.00D-14*EXP(1000./TEMP)
  k(398)   = 2.96D-14*EXP(1000./TEMP)
  k(399)   = 2.96D-14*EXP(1000./TEMP)
  k(400)   = 2.96D-14*EXP(1000./TEMP)
  k(401)   = 4.25D-14*EXP(1000./TEMP)
  k(402)   = 4.25D-14*EXP(1000./TEMP)
  k(403)   = 1.2D-12
  k(404)   = 2.5D-12*EXP(500./TEMP)
  k(405)   = 7.13D-17*EXP(2950./TEMP)
  k(406)   = 4.8D-12
  k(407)   = 7.29D-11
  k(408)   = 1.67D-16
  k(409)   = KTYP2(2.4D-14,460.0D0,2.7D-17,2199.0D0,6.5D-34,1335.0D0,TEMP,AIR)
  k(410)   = 7.3D-11
  k(411)   = 4.1D-11
  k(412)   = 1.79D-12
  k(413)   = 4.12D8*EXP(-7700./TEMP)
  k(414)   = 1.77D-11*EXP(500./TEMP)
  k(415)   = 9.03D-16*EXP(-845./TEMP)
  k(416)   = 2.7D-12*EXP(360./TEMP)
  k(417)   = 2.06D-13*EXP(1300./TEMP)
  k(418)   = 7.5D-14
  k(419)   = 9.53D-14*EXP(500.0/TEMP)
  k(420)   = 2.3D-12
  k(421)   = 2.43D-12*EXP(500./TEMP)
  k(422)   = 5.04D-14*EXP(-1800./TEMP)
  k(423)   = 2.7D-12*EXP(360./TEMP)
  k(424)   = 2.06D-13*EXP(1300./TEMP)
  k(425)   = 6.7D-13
  k(426)   = 8.16D-13*EXP(500./TEMP)
  k(427)   = 2.3D-12
  k(428)   = 4.6D-11
  k(429)   = 5.78D-11*EXP(-400./TEMP)
  k(430)   = 2.7D-12*EXP(360./TEMP)
  k(431)   = 7.4D-13*EXP(700./TEMP)
  k(432)   = 2.3D-12
  k(433)   = 1.0D-12
  k(434)   = 1.0D-11
  k(435)   = 7.2D-12
  k(436)   = 1.67D-11*EXP(200./TEMP)
  k(437)   = 1.1D-10
  k(438)   = 4.0D-17
  k(439)   = 5.95D-12*EXP(-1860./TEMP)
  k(440)   = 2.7D-12*EXP(360./TEMP)
  k(441)   = 2.06D-13*EXP(1300./TEMP)
  k(442)   = 8.24D-14
  k(443)   = 1.04D-13*EXP(500./TEMP)
  k(444)   = 2.3D-12
  k(445)   = 7.5D-12*EXP(290./TEMP)
  k(446)   = 5.2D-13*EXP(980./TEMP)
  k(447)   = 8.83D-13*EXP(500./TEMP)
  k(448)   = 2.9D-12 *EXP(500./TEMP)
  k(449)   = 4.0D-12
  k(450)   = TJPL(9.7D-29,5.6D0,9.3D-12,1.5D0,TEMP,AIR)
  k(451)   = 2.7D-11*EXP(200./TEMP)
  k(452)   = 2.7D-12*EXP(360./TEMP)
  k(453)   = 2.06D-13*EXP(1300./TEMP)
  k(454)   = 4.6D-13
  k(455)   = 5.8D-13*EXP(500./TEMP)
  k(456)   = 2.3D-12
  k(457)   = 3.0D-12
  k(458)   = 2.0D-17
  k(459)   = 8.0D-12
  k(460)   = 2.06D-13*EXP(1300./TEMP)
  k(461)   = 3.55D-12
  k(462)   = 4.23D-12*EXP(500./TEMP)
  k(463)   = 2.3D-12
  k(464)   = 1.6D-12*EXP(305./TEMP)
  k(465)   = 1.0D-11
  k(466)   = 1.4D-12*EXP(-1860./TEMP)
  k(467)   = 1.0D-11
  k(468)   = 8.0D-13
  k(469)   = 2.9D7*EXP(-5297./TEMP)
  k(470)   = 2.7D-12*EXP(360./TEMP)
  k(471)   = 1.8D-13*EXP(1300./TEMP)
  k(472)   = 2.04D-13
  k(473)   = 2.58D-13*EXP(500./TEMP)
  k(474)   = 2.3D-12
  k(475)   = 3.8D-12*EXP(200./TEMP)
  k(476)   = 5.0D-11
  k(477)   = 5.6D-12

  return
end subroutine GasThermalRateCoeffs

!**********************************************************************************************************************!
!  Reaction rate coefficient functions
!**********************************************************************************************************************!
!  Arrhenius equation with temperature dependence of A0
function ARR(A0,E0,B0,TEMP)
   real(kind=dp), intent(in) :: A0, E0, B0, TEMP  ! temp (K)
   real(kind=dp) :: ARR
   ARR = A0*exp(E0/TEMP)*(TEMP/300.0_dp)**(-B0)
   return
end function ARR

!  Arrhenius equation
function ARR2(A0,E0,TEMP)
   real(kind=dp), intent(in) :: A0, E0, TEMP      ! temp (K)
   real(kind=dp) :: ARR2
   ARR2 = A0*exp(E0/TEMP)
   return
end function ARR2

!  full termolecular rate expression
function TERM(A0,B0,E0,Ai,Bi,Ei,F,TEMP,AIR)
   real(kind=dp), intent(in) :: A0, B0, E0        ! Arrhenius parameters for the low
                                                  ! pressure limit
   real(kind=dp), intent(in) :: Ai, Bi, Ei        ! Arrhenius parameters for the high
                                                  ! pressure limit
   real(kind=dp), intent(in) :: F                 ! base and exponent parameters
   real(kind=dp), intent(in) :: TEMP, AIR         ! temp (K) and cair (molec/cc)
   real(kind=dp) :: TERM
   real(kind=dp)    :: k0, ki, rk, logrk, g

   k0 = ARR(A0,E0,B0,TEMP)
   ki = ARR(Ai,Ei,Bi,TEMP)
   rk = k0*AIR/ki
   logrk = DLOG10(rk)
   g = 1.0_dp/(1.0_dp + (logrk*logrk))
   TERM = (k0*AIR/(1.0_dp + rk))*F**g
   return
end function TERM

!  JPL-style termolecular rate expression
function TJPL(A0,B0,Ai,Bi,TEMP,AIR)
   real(kind=dp), intent(in) :: A0, B0        ! Arrhenius parameters for the low
                                              ! pressure limit
   real(kind=dp), intent(in) :: Ai, Bi        ! Arrhenius parameters for the high
                                              ! pressure limit
   real(kind=dp), intent(in) :: TEMP, AIR     ! temp (K) and cair (molec/cc)
   real(kind=dp)             :: F             ! base and exponent parameters
   real(kind=dp)             :: TJPL
   real(kind=dp)             :: k0, ki, rk, logrk, g
   F = 0.6_dp
   k0 = ARR(A0,0.0_dp,B0,TEMP)
   ki = ARR(Ai,0.0_dp,Bi,TEMP)
   rk = k0*AIR/ki
   logrk = DLOG10(rk)
   g = 1.0_dp/(1.0_dp + (logrk*logrk))
   TJPL = (k0*AIR/(1.0_dp + rk))*F**g
   return
end function TJPL

!  JPL-style termolecular rate expression for CO + OH = H + CO2
function TERCO(A0,B0,Ai,Bi,TEMP,AIR)
   real(kind=dp), intent(in) :: A0, B0       ! Arrhenius parameters for the low
                                             ! pressure limit
   real(kind=dp), intent(in) :: Ai, Bi       ! Arrhenius parameters for the high
                                             ! pressure limit
   real(kind=dp), intent(in) :: TEMP, AIR    ! temp (K) and cair (molec/cc)
   real(kind=dp)             :: F            ! base and exponent parameters
   real(kind=dp)             :: TERCO
   real(kind=dp)             :: k0, ki, rk, logrk, g
   F = 0.6_dp
   k0 = ARR(A0,0.0_dp,B0,TEMP)
   ki = ARR(Ai,0.0_dp,Bi,TEMP)
   rk = k0/(ki/AIR)
   logrk = DLOG10(rk)
   g = 1.0_dp/(1.0_dp + (logrk*logrk))
   TERCO = (k0/(1.0_dp + rk))*F**g
   return
end function TERCO

!  special rate expression function type 2
function KTYP2(A0,E0,A2,E2,A3,E3,TEMP,AIR)
   real(kind=dp), intent(in) :: A0, E0
   real(kind=dp), intent(in) :: A2, E2
   real(kind=dp), intent(in) :: A3, E3
   real(kind=dp), intent(in) :: TEMP, AIR          ! temp (K) and cair (molec/cc)
   real(kind=dp) :: k0, k2, k3, k1
   real(kind=dp) :: KTYP2
   k0 = ARR(A0,E0,0.0_dp,TEMP)
   k2 = ARR(A2,E2,0.0_dp,TEMP)
   k3 = ARR(A3,E3,0.0_dp,TEMP)
   k1 = k3*AIR/(1.0_dp+(k3*AIR/k2)) 
   KTYP2 = k0 + k1
   return
end function KTYP2

!  special rate expression function type 3
function KTYP3(A1,E1,A2,E2,TEMP,AIR)
   real(kind=dp), intent(in) :: A1, E1
   real(kind=dp), intent(in) :: A2, E2
   real(kind=dp), intent(in) :: TEMP, AIR         ! temp (K) and cair (molec/cc)
   real(kind=dp) :: k1, k2
   real(kind=dp) :: KTYP3
   k1 = ARR(A1,E1,0.0_dp,TEMP)
   k2 = ARR(A2,E2,0.0_dp,TEMP)
   KTYP3 = k1 + k2*AIR
   return
end function KTYP3

!  special rate expression function for HO2 + HO2 = H2O2
function KTYPHO2(A0,E0,A1,E1,A2,E2,TEMP,AIR,H2O)
   real(kind=dp), intent(in) :: A0, E0
   real(kind=dp), intent(in) :: A1, E1
   real(kind=dp), intent(in) :: A2, E2
   real(kind=dp), intent(in) :: TEMP, AIR, H2O       ! temp (K), cair (molec/cc) & h2o (molec/cc)
   real(kind=dp) :: ka, kb, kh2o
   real(kind=dp) :: KTYPHO2
   ka = A0*EXP(E0/TEMP)
   kb = A1*AIR*EXP(E1/TEMP)
   kh2o = A2*H2O*EXP(E2/TEMP)
   KTYPHO2 = (ka + kb)*(1.0_dp+kh2o)
   return
end function KTYPHO2

! Self-reaction parameterization for peroxy radicals
!  Only used in the CBMz mechanism
!  Zaveri & Peters (1999) JGR, 104, 30387-30415.
!
function PEROXY(iperox,ch3o2,ethp,ro2,c2o3,ano2,nap,isopp,isopn,isopo2,xo2,TEMP)
  real(kind=dp), intent(in) :: ch3o2,ethp,ro2,c2o3,ano2,nap,isopp,isopn,isopo2,xo2
  real(kind=dp), intent(in) :: TEMP
  integer, intent(in)       :: iperox
  !                               =  1  : ch3o2
  !                               =  2  : ethp
  !                               =  3  : ro2
  !                               =  4  : c2o3
  !                               =  5  : ano2
  !                               =  6  : nap
  !                               =  7  : isopp
  !                               =  8  : isopn
  !                               =  9  : isopo2
  !                               = 10  : xo2
  integer :: nperox, i, j
  parameter(nperox=10)
  real(kind=dp), dimension(nperox,nperox) :: aperox, bperox
  real(kind=dp), dimension(nperox,nperox) :: rk_perox
  real(kind=dp), dimension(nperox)        :: rk_param, sperox
  real(kind=dp)             :: PEROXY
 
  sperox(1)=ch3o2
  sperox(2)=ethp
  sperox(3)=ro2
  sperox(4)=c2o3
  sperox(5)=ano2
  speroX(6)=nap
  sperox(7)=isopp
  sperox(8)=isopn
  sperox(9)=isopo2
  sperox(10)=xo2
 
  aperox = 0.0
  aperox(1,1)=2.5e-13
  aperox(2,2)=6.8e-14
  aperox(3,3)=2.9e-12
  aperox(4,4)=8.0e-12
  aperox(5,5)=1.0e-12
  aperox(6,6)=5.3e-16
  aperox(7,7)=3.1e-14
  aperox(8,8)=3.1e-14
  aperox(9,9)=3.1e-14
  aperox(10,10)=3.1e-14

  bperox = 0.0
  bperox(1,1)=190.
  bperox(2,2)=0.0
  bperox(3,3)=500.
  bperox(4,4)=0.0
  bperox(5,5)=0.0
  bperox(6,6)=1980.
  bperox(7,7)=1000.
  bperox(8,8)=1000.
  bperox(9,9)=1000.
  bperox(10,10)=1000.

  do i=1,nperox
  do j=1,nperox
    if(i .ne. j) then
      aperox(i,j)=2.0*sqrt(aperox(i,i)*aperox(j,j))
      bperox(i,j)=0.5*(bperox(i,i)+bperox(j,j))
    endif
  end do 
  end do
  aperox(3,1)=1.3e-12
  aperox(1,3)=1.3e-12
  bperox(3,1)=640.0
  bperox(1,3)=640.0

  rk_param = 0.0
  rk_perox = 0.0
  do i=1,nperox
  do j=1,nperox
    rk_perox(i,j)=ARR2(aperox(i,j),bperox(i,j),TEMP)
    rk_param(i)=rk_param(i)+rk_perox(i,j)*sperox(j)
  end do 
  end do

  PEROXY=rk_param(iperox)

  return
 
end function PEROXY

!  end of reaction rate coefficient functions
!**********************************************************************************************************************!

end module GasChem
!======================================================================================================================!
